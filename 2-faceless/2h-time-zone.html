<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.49" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://wings.fessional.pro/2-faceless/2h-time-zone.html"><meta property="og:site_name" content="WingsBoot"><meta property="og:title" content="2H.时间和时区"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-06-23T10:44:09.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-06-23T10:44:09.000Z"><link rel="stylesheet" href="//at.alicdn.com/t/font_2410206_mfj6e1vbwo.css"><title>2H.时间和时区 | WingsBoot</title><meta name="description" content="快速实现业务目标；及时偿还技术债务；安全重构程序和业务">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.c8ebf257.css">
    <link rel="modulepreload" href="/assets/app.f1aca755.js"><link rel="modulepreload" href="/assets/2h-time-zone.html.4fc998c6.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/assets/2h-time-zone.html.99869526.js"><link rel="prefetch" href="/assets/index.html.a9ac37d2.js"><link rel="prefetch" href="/assets/0a-code-style.html.4111979a.js"><link rel="prefetch" href="/assets/0b-rest-half.html.d5206e9b.js"><link rel="prefetch" href="/assets/0c-dev-tool.html.886dc052.js"><link rel="prefetch" href="/assets/0d-qa-devops.html.670b2882.js"><link rel="prefetch" href="/assets/0e-qa-config.html.8085edf0.js"><link rel="prefetch" href="/assets/0f-qa-others.html.a151a715.js"><link rel="prefetch" href="/assets/0g-ghost-ship.html.55be84d9.js"><link rel="prefetch" href="/assets/0h-prop-index.html.b522b632.js"><link rel="prefetch" href="/assets/index.html.6c9d5122.js"><link rel="prefetch" href="/assets/1a-wings-conf.html.531bc279.js"><link rel="prefetch" href="/assets/1b-wings-i18n.html.d7c5e2bc.js"><link rel="prefetch" href="/assets/1c-spring-auto.html.e8c0251e.js"><link rel="prefetch" href="/assets/1d-prop-silencer.html.2ebbd1cc.js"><link rel="prefetch" href="/assets/index.html.334e3ba8.js"><link rel="prefetch" href="/assets/2a-flywave.html.6720e876.js"><link rel="prefetch" href="/assets/2b-jooq.html.29b2f40e.js"><link rel="prefetch" href="/assets/2c-shard.html.61e30173.js"><link rel="prefetch" href="/assets/2d-mysql-h2.html.911e0b02.js"><link rel="prefetch" href="/assets/2e-qa-flywave.html.d57f7d89.js"><link rel="prefetch" href="/assets/2f-qa-jooq.html.76460504.js"><link rel="prefetch" href="/assets/2g-qa-shard.html.865fdbaf.js"><link rel="prefetch" href="/assets/2i-prop-faceless.html.7e062239.js"><link rel="prefetch" href="/assets/2j-prop-flywave.html.9f8b32b7.js"><link rel="prefetch" href="/assets/2k-prop-jooq.html.fabd4506.js"><link rel="prefetch" href="/assets/index.html.a5abcd5c.js"><link rel="prefetch" href="/assets/3a-jackson.html.d38d7b47.js"><link rel="prefetch" href="/assets/3b-hazelcast.html.4a88bc92.js"><link rel="prefetch" href="/assets/3c-host-ext.html.02a7c458.js"><link rel="prefetch" href="/assets/3d-i18n-zone.html.b9e89a89.js"><link rel="prefetch" href="/assets/3e-auth-session.html.0de8eb16.js"><link rel="prefetch" href="/assets/3f-cache-event.html.5e2e2556.js"><link rel="prefetch" href="/assets/3g-fun-server.html.9671e5e5.js"><link rel="prefetch" href="/assets/3h-qa-slardar.html.8161f993.js"><link rel="prefetch" href="/assets/3i-prop-slardar.html.fe437bb1.js"><link rel="prefetch" href="/assets/3j-prop-webmvc.html.be848d2c.js"><link rel="prefetch" href="/assets/3k-prop-function.html.eb1252d2.js"><link rel="prefetch" href="/assets/3l-prop-hazelcast.html.af8b3e73.js"><link rel="prefetch" href="/assets/index.html.a994923e.js"><link rel="prefetch" href="/assets/4a-authn.html.959dc21f.js"><link rel="prefetch" href="/assets/4b-authz.html.61761355.js"><link rel="prefetch" href="/assets/4c-security.html.3d5ebd06.js"><link rel="prefetch" href="/assets/4d-prop-warlock.html.e0aa747b.js"><link rel="prefetch" href="/assets/index.html.555319ff.js"><link rel="prefetch" href="/assets/index.html.32d4c095.js"><link rel="prefetch" href="/assets/index.html.c3f469a2.js"><link rel="prefetch" href="/assets/5a1.mirana.html.751f2de8.js"><link rel="prefetch" href="/assets/5a2.utilities.html.0a843888.js"><link rel="prefetch" href="/assets/index.html.042428c0.js"><link rel="prefetch" href="/assets/5b1.meepo.html.396eb871.js"><link rel="prefetch" href="/assets/5b2.example.html.2ba4a142.js"><link rel="prefetch" href="/assets/5b3.syntax.html.b00db39b.js"><link rel="prefetch" href="/assets/5b4.engine.html.d4ce0a2e.js"><link rel="prefetch" href="/assets/5b5.function.html.14effaf9.js"><link rel="prefetch" href="/assets/5b6.question.html.dc6e333f.js"><link rel="prefetch" href="/assets/index.html.5994cf4c.js"><link rel="prefetch" href="/assets/9a1.242-201.html.50fb0bd0.js"><link rel="prefetch" href="/assets/9a2.266-210.html.6da21ab6.js"><link rel="prefetch" href="/assets/index.html.c99e34c3.js"><link rel="prefetch" href="/assets/9b1.web-service.html.d6a38e7f.js"><link rel="prefetch" href="/assets/9b2.actuator-admin.html.9bc9c376.js"><link rel="prefetch" href="/assets/9b3.spel-sample.html.e26c7334.js"><link rel="prefetch" href="/assets/index.html.4177eae3.js"><link rel="prefetch" href="/assets/9c1.mysql-dump-restore.html.b516dd21.js"><link rel="prefetch" href="/assets/9c2.request-record-replay.html.94302413.js"><link rel="prefetch" href="/assets/index.html.08863e0e.js"><link rel="prefetch" href="/assets/9d1.jooq-dsl-gen.html.0cbcd470.js"><link rel="prefetch" href="/assets/index.html.bdf65db1.js"><link rel="prefetch" href="/assets/404.html.64e5dc8b.js"><link rel="prefetch" href="/assets/index.html.4289863c.js"><link rel="prefetch" href="/assets/0a-code-style.html.a1d4b195.js"><link rel="prefetch" href="/assets/0b-rest-half.html.f47ec955.js"><link rel="prefetch" href="/assets/0c-dev-tool.html.e7371db3.js"><link rel="prefetch" href="/assets/0d-qa-devops.html.a743434b.js"><link rel="prefetch" href="/assets/0e-qa-config.html.2cad2c0a.js"><link rel="prefetch" href="/assets/0f-qa-others.html.bd3b05c6.js"><link rel="prefetch" href="/assets/0g-ghost-ship.html.03b338a5.js"><link rel="prefetch" href="/assets/0h-prop-index.html.166e76e1.js"><link rel="prefetch" href="/assets/index.html.e86f3e6f.js"><link rel="prefetch" href="/assets/1a-wings-conf.html.7c5ec5e4.js"><link rel="prefetch" href="/assets/1b-wings-i18n.html.8a654621.js"><link rel="prefetch" href="/assets/1c-spring-auto.html.6c710e5e.js"><link rel="prefetch" href="/assets/1d-prop-silencer.html.663ead43.js"><link rel="prefetch" href="/assets/index.html.d6620fa5.js"><link rel="prefetch" href="/assets/2a-flywave.html.5d51d334.js"><link rel="prefetch" href="/assets/2b-jooq.html.8390c20d.js"><link rel="prefetch" href="/assets/2c-shard.html.f8d074e3.js"><link rel="prefetch" href="/assets/2d-mysql-h2.html.fff52fa7.js"><link rel="prefetch" href="/assets/2e-qa-flywave.html.0e7d202b.js"><link rel="prefetch" href="/assets/2f-qa-jooq.html.a11fa290.js"><link rel="prefetch" href="/assets/2g-qa-shard.html.051a7895.js"><link rel="prefetch" href="/assets/2i-prop-faceless.html.1fecb147.js"><link rel="prefetch" href="/assets/2j-prop-flywave.html.7395d592.js"><link rel="prefetch" href="/assets/2k-prop-jooq.html.2931dbf2.js"><link rel="prefetch" href="/assets/index.html.ef3c085a.js"><link rel="prefetch" href="/assets/3a-jackson.html.10e95bcd.js"><link rel="prefetch" href="/assets/3b-hazelcast.html.000461a0.js"><link rel="prefetch" href="/assets/3c-host-ext.html.03745b9c.js"><link rel="prefetch" href="/assets/3d-i18n-zone.html.84fae53d.js"><link rel="prefetch" href="/assets/3e-auth-session.html.b17f2763.js"><link rel="prefetch" href="/assets/3f-cache-event.html.c0ff7f25.js"><link rel="prefetch" href="/assets/3g-fun-server.html.ec522286.js"><link rel="prefetch" href="/assets/3h-qa-slardar.html.9562020a.js"><link rel="prefetch" href="/assets/3i-prop-slardar.html.c1359a1c.js"><link rel="prefetch" href="/assets/3j-prop-webmvc.html.309c68e9.js"><link rel="prefetch" href="/assets/3k-prop-function.html.83a2cc83.js"><link rel="prefetch" href="/assets/3l-prop-hazelcast.html.3e092acf.js"><link rel="prefetch" href="/assets/index.html.c445dfd8.js"><link rel="prefetch" href="/assets/4a-authn.html.b1393908.js"><link rel="prefetch" href="/assets/4b-authz.html.6969ebb0.js"><link rel="prefetch" href="/assets/4c-security.html.0d14bf10.js"><link rel="prefetch" href="/assets/4d-prop-warlock.html.28c32870.js"><link rel="prefetch" href="/assets/index.html.05412ccc.js"><link rel="prefetch" href="/assets/index.html.3642164d.js"><link rel="prefetch" href="/assets/index.html.eb66b85f.js"><link rel="prefetch" href="/assets/5a1.mirana.html.377eede7.js"><link rel="prefetch" href="/assets/5a2.utilities.html.8a70bed8.js"><link rel="prefetch" href="/assets/index.html.5983e489.js"><link rel="prefetch" href="/assets/5b1.meepo.html.279a4dc3.js"><link rel="prefetch" href="/assets/5b2.example.html.acc2c6a1.js"><link rel="prefetch" href="/assets/5b3.syntax.html.4f15d573.js"><link rel="prefetch" href="/assets/5b4.engine.html.004c4607.js"><link rel="prefetch" href="/assets/5b5.function.html.eb72f6d7.js"><link rel="prefetch" href="/assets/5b6.question.html.5b3bc045.js"><link rel="prefetch" href="/assets/index.html.21af65c7.js"><link rel="prefetch" href="/assets/9a1.242-201.html.2f3a0077.js"><link rel="prefetch" href="/assets/9a2.266-210.html.cef46209.js"><link rel="prefetch" href="/assets/index.html.e2d8c3ef.js"><link rel="prefetch" href="/assets/9b1.web-service.html.f868917e.js"><link rel="prefetch" href="/assets/9b2.actuator-admin.html.0137c561.js"><link rel="prefetch" href="/assets/9b3.spel-sample.html.17c0e4e4.js"><link rel="prefetch" href="/assets/index.html.ced49711.js"><link rel="prefetch" href="/assets/9c1.mysql-dump-restore.html.4788154d.js"><link rel="prefetch" href="/assets/9c2.request-record-replay.html.aed88a7c.js"><link rel="prefetch" href="/assets/index.html.5f849c72.js"><link rel="prefetch" href="/assets/9d1.jooq-dsl-gen.html.b1031067.js"><link rel="prefetch" href="/assets/index.html.ed488f64.js"><link rel="prefetch" href="/assets/404.html.b1d4727e.js"><link rel="prefetch" href="/assets/404.abc5c68f.js"><link rel="prefetch" href="/assets/Layout.be718552.js"><link rel="prefetch" href="/assets/giscus.es.e12125a3.js"><link rel="prefetch" href="/assets/photoswipe.esm.351abe37.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/logo.png" alt="WingsBoot"><!----><span class="site-name hide-in-pad">WingsBoot</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/0-wings/" class="nav-link" aria-label="神翼"><span class="icon iconfont icon-discover"></span>神翼<!----></a></div><div class="nav-item hide-in-mobile"><a href="/1-silence/" class="nav-link" aria-label="沉默"><span class="icon iconfont icon-define"></span>沉默<!----></a></div><div class="nav-item hide-in-mobile"><a href="/2-faceless/" class="nav-link active" aria-label="虚空"><span class="icon iconfont icon-time"></span>虚空<!----></a></div><div class="nav-item hide-in-mobile"><a href="/3-slardar/" class="nav-link" aria-label="鱼人"><span class="icon iconfont icon-speed"></span>鱼人<!----></a></div><div class="nav-item hide-in-mobile"><a href="/4-warlock/" class="nav-link" aria-label="术士"><span class="icon iconfont icon-proxy"></span>术士<!----></a></div><div class="nav-item hide-in-mobile"><a href="/5-radiant/" class="nav-link" aria-label="天辉"><span class="icon iconfont icon-config"></span>天辉<!----></a></div><div class="nav-item hide-in-mobile"><a href="/9-example/" class="nav-link" aria-label="实战"><span class="icon iconfont icon-actions"></span>实战<!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/trydofor/pro.fessional.wings" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><div id="docsearch-container"></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/2-faceless/" class="nav-link sidebar-link sidebar-page" aria-label="2.虚空假面"><span class="icon iconfont icon-time"></span>2.虚空假面<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2a-flywave.html" class="nav-link sidebar-link sidebar-page" aria-label="2A.表和数据的版本"><span class="icon iconfont icon-git"></span>2A.表和数据的版本<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2b-jooq.html" class="nav-link sidebar-link sidebar-page" aria-label="2B.强类型及DSL能力"><span class="icon iconfont icon-ability"></span>2B.强类型及DSL能力<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2c-shard.html" class="nav-link sidebar-link sidebar-page" aria-label="2C.按需分表分库"><span class="icon iconfont icon-tree"></span>2C.按需分表分库<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2d-mysql-h2.html" class="nav-link sidebar-link sidebar-page" aria-label="2D.Mysql体系的知识"><span class="icon iconfont icon-mysql"></span>2D.Mysql体系的知识<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2e-qa-flywave.html" class="nav-link sidebar-link sidebar-page" aria-label="2E.Flywave话题"><span class="icon iconfont icon-git"></span>2E.Flywave话题<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2f-qa-jooq.html" class="nav-link sidebar-link sidebar-page" aria-label="2F.Jooq使用话题"><span class="icon iconfont icon-ability"></span>2F.Jooq使用话题<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2g-qa-shard.html" class="nav-link sidebar-link sidebar-page" aria-label="2G.分表分库话题"><span class="icon iconfont icon-tree"></span>2G.分表分库话题<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/2-faceless/2h-time-zone.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="2H.时间和时区"><span class="icon iconfont icon-time"></span>2H.时间和时区<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/2-faceless/2h-time-zone.html#_2h-1-日时零值和时区" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2H.1.日时零值和时区"><!---->2H.1.日时零值和时区<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/2-faceless/2h-time-zone.html#_2h-2-数据库和jvm时区" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2H.2.数据库和Jvm时区"><!---->2H.2.数据库和Jvm时区<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/2-faceless/2i-prop-faceless.html" class="nav-link sidebar-link sidebar-page" aria-label="2I.虚空的属性"><span class="icon iconfont icon-enum"></span>2I.虚空的属性<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2j-prop-flywave.html" class="nav-link sidebar-link sidebar-page" aria-label="2J.飞波的属性"><span class="icon iconfont icon-enum"></span>2J.飞波的属性<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/2-faceless/2k-prop-jooq.html" class="nav-link sidebar-link sidebar-page" aria-label="2K.Jooq的属性"><span class="icon iconfont icon-enum"></span>2K.Jooq的属性<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-time"></span>2H.时间和时区</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down" localizeddate="2022年6月23日" isoriginal="true" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://www.trydofor.com" target="_blank" rel="noopener noreferrer">trydofor</a></span><span property="author" content="trydofor"></span></span><span class="origin" localizeddate="2022年6月23日" pageview="false" pure="false">原创</span><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down" isoriginal="true" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年6月23日</span><meta property="datePublished" content="2022-06-23T10:44:09.000Z"></span><span class="category-info" aria-label="分类🌈" data-balloon-pos="down" localizeddate="2022年6月23日" isoriginal="true" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category4" role>虚空</li><li class="category category3" role>时间</li><li class="category category7" role>约定</li><meta property="articleSection" content="虚空,时间,约定"></ul></span><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down" localizeddate="2022年6月23日" isoriginal="true" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 4 分钟</span><meta property="timeRequired" content="PT4M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/2-faceless/2h-time-zone.html#_2h-1-日时零值和时区" class="router-link-active router-link-exact-active toc-link level2">2H.1.日时零值和时区</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/2-faceless/2h-time-zone.html#_2h-2-数据库和jvm时区" class="router-link-active router-link-exact-active toc-link level2">2H.2.数据库和Jvm时区</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="_2h-时间和时区" tabindex="-1"><a class="header-anchor" href="#_2h-时间和时区" aria-hidden="true">#</a> 2H.时间和时区</h1><p>数据库有关的时间，时区，零值约定</p><h2 id="_2h-1-日时零值和时区" tabindex="-1"><a class="header-anchor" href="#_2h-1-日时零值和时区" aria-hidden="true">#</a> 2H.1.日时零值和时区</h2><p>执行环境和数据库要在同一时区，否则jooq和jdbc在以下过程会自动转换时区，引发问题。</p><p>如果服务器和执行环境时区不一致，可以通过以下方式协调。</p><ul><li>通过wings的参数设置时区 <code>wings.silencer.i18n.zoneid=Asia/Shanghai</code></li><li>java的启动参数， <code>-Duser.timezone=Asia/Shanghai</code></li><li>mysql的jdbc的url参数， <code>connectionTimeZone=%2B08:00&amp;forceConnectionTimeZoneToSession=true</code></li><li>java的代码参数， <code>TimeZone.setDefault(TimeZone.getTimeZone(&quot;Asia/Shanghai&quot;));</code></li></ul><p>在数据库和java配置上，需要统一时区和dev状态下的用户名和密码，一般团队一致。</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">wings.silencer.i18n.zoneid</span><span class="token punctuation">=</span><span class="token value attr-value">Asia/Shanghai</span>
<span class="token comment"># 常用jdbc参数</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/wings_example\
  ?autoReconnect=true&amp;useSSL=false\
  &amp;useUnicode=true&amp;characterEncoding=UTF-8\
  &amp;connectionTimeZone=Asia/Shanghai</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>引发问题的原因，目前断定为jdbc和timestamp历史问题（wings210后统一mysql8，已统一解决）</p><ul><li>jooq，使用timestamp作为localDatetime的值，设置preparedStatement。</li><li>jdbc，setTimestamp(int parameterIndex, Timestamp x), the JDBC driver uses the time zone of the virtual machine to calculate the date and time of the timestamp in that time zone.</li></ul><p>通过以下SQL可以在mysql端调查数据库执行过程</p><div class="language-sql ext-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- 查看 系统，程序，会话时区</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@system_time_zone</span><span class="token punctuation">,</span>  @<span class="token variable">@global.time_zone</span><span class="token punctuation">,</span> @<span class="token variable">@session.time_zone</span><span class="token punctuation">;</span>
<span class="token comment">-- @@system_time_zone, @@global.time_zone, @@session.time_zone</span>
<span class="token comment">-- UTC, Asia/Shanghai, Asia/Shanghai</span>

<span class="token comment">-- mysql 执行日志(UTC)</span>
<span class="token keyword">select</span> <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>win_user<span class="token punctuation">`</span></span> <span class="token keyword">where</span> <span class="token identifier"><span class="token punctuation">`</span>delete_dt<span class="token punctuation">`</span></span> <span class="token operator">&lt;=</span> <span class="token string">&#39;0999-12-31 16:00:00.0&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- jooq 绑定日志(GMT+8)</span>
<span class="token keyword">select</span> <span class="token identifier"><span class="token punctuation">`</span>id<span class="token punctuation">`</span></span> <span class="token keyword">from</span> <span class="token identifier"><span class="token punctuation">`</span>win_user<span class="token punctuation">`</span></span> <span class="token keyword">where</span> <span class="token identifier"><span class="token punctuation">`</span>delete_dt<span class="token punctuation">`</span></span> <span class="token operator">&lt;=</span> <span class="token string">&#39;1000-01-01 00:00:00.0&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 打开，日志，blob要</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> log_output <span class="token operator">=</span> <span class="token string">&#39;TABLE&#39;</span><span class="token punctuation">;</span><span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> general_log <span class="token operator">=</span> <span class="token string">&#39;ON&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">from</span> mysql<span class="token punctuation">.</span>general_log <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> event_time <span class="token keyword">DESC</span><span class="token punctuation">;</span>
<span class="token comment">-- 关闭，清除</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> log_output <span class="token operator">=</span> <span class="token string">&#39;TABLE&#39;</span><span class="token punctuation">;</span> <span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> general_log <span class="token operator">=</span> <span class="token string">&#39;OFF&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">truncate</span> <span class="token keyword">table</span> mysql<span class="token punctuation">.</span>general_log<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The session time zone setting affects display and storage of time values that are zone-sensitive. This includes the values displayed by functions such as NOW() or CURTIME(), and values stored in and retrieved from TIMESTAMP columns. Values for TIMESTAMP columns are converted from the session time zone to UTC for storage, and from UTC to the session time zone for retrieval.</p><p>在mysql中，尽量使用NOW(fsp)，因为其短小明确有缓存，如无必须不可使用SYSDATE(fsp)，参考</p><ul><li><a href="https://dev.mysql.com/doc/refman/8.0/en/time-zone-support.html#time-zone-variables" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/time-zone-support.html#time-zone-variables<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_now" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_now<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-configuration-properties.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-reference-configuration-properties.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-connp-props-datetime-types-processing.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/connector-j/8.0/en/connector-j-connp-props-datetime-types-processing.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="_2h-2-数据库和jvm时区" tabindex="-1"><a class="header-anchor" href="#_2h-2-数据库和jvm时区" aria-hidden="true">#</a> 2H.2.数据库和Jvm时区</h2><p>常用的时区有2中格式，不管那种，都推荐使用稳定时区，如政策不会变，没有夏令时。</p><ul><li>容易理解的ZoneId形式 - 地理城市 Asia/Shanghai，America/New_York</li><li>规则稳定的Offset形式 - 相对于UTC的时差，UTC，+08:00</li></ul><p>wings中使用DatabaseChecker检查以下②③④时差是否一致，推荐全部一致。</p><ul><li>①system_time_zone - mysql host machine</li><li>②time_zone - mysql current time zone</li><li>③connectionTimeZone - jdbc connectionTimeZone/serverTimezone</li><li>④jvm TimeZone - jvm DefaultTimeZone</li><li>⑤host TimeZone - java host machine</li></ul><p>其中③是jdbc中特有的，和session timezone类似，但比<code>SET time_zone = timezone</code>强大。 若③④一致则不影响使用，但若非wings环境，在未设置③导致mysql默认使用②时，就会出现时差问题。</p><p>使用NOW()及TIMESTAMP类型时要注意时区，他们受③的影响。</p><blockquote><p>The session time zone setting affects display and storage of time values that are zone-sensitive. This includes the values displayed by functions such as NOW() or CURTIME(), and values stored in and retrieved from TIMESTAMP columns. Values for TIMESTAMP columns are converted from the session time zone to UTC for storage, and from UTC to the session time zone for retrieval.</p></blockquote><p>尽量使用 DATE, TIME, DATETIME类型，他们是时区无关的。</p><blockquote><p>The session time zone setting does not affect values displayed by functions such as UTC_TIMESTAMP() or values in DATE, TIME, or DATETIME columns. Nor are values in those data types stored in UTC; the time zone applies for them only when converting from TIMESTAMP values. If you want locale-specific arithmetic for DATE, TIME, or DATETIME values, convert them to UTC, perform the arithmetic, and then convert back.</p></blockquote><p>以上是数据库层面需要注意的地方，而以下为jdbc及java体系中的注意点，</p><ul><li>connectionTimeZone和forceConnectionTimeZoneToSession同时使用。</li><li>connectionTimeZone的值，建议使用offset形式，<code>UTC</code>, <code>-40:00</code>, <code>+80:00</code></li><li>在jdbc url中，需要转义<code>+</code>，以<code>%2B08:00</code>表示<code>+80:00</code></li><li>业务侧建议使用ZoneId形式，mysql配置项，建议是有offset形式</li></ul><p>connectionTimeZone参数（8.0之前是serverTimezone）可以协调好jvm和mysql的时区， 单独使用connectionTimeZone，不会改变session级的time_zone， 需要配合forceConnectionTimeZoneToSession，才能达到session和jdbc一致的效果。</p><p>尽管以上设置可以满足项目要求，但因作用范围不如统一时区更稳定可靠，仍应避免使用。 此外在mysql配额中，建议使用offset格式时区，而业务侧使用ZoneId格式。</p><p>在配置JdbcUrl时，若使用<code>+</code>时（如下所示），会发生DateTimeException，因为在URL中<code>+</code>标识空格。 需要转义为<code>%2B</code>，即正确的格式为connectionTimeZone=%2B08:00</p><blockquote><p>wings_test?connectionTimeZone=+08:00` Invalid ID for region-based ZoneId, invalid format: 08:00</p></blockquote></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/fessionalpro/wings-doc/edit/main/docs/2-faceless/2h-time-zone.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/6/23 10:44:09</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: trydofor@gmail.com">trydofor</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/2-faceless/2g-qa-shard.html" class="nav-link prev" aria-label="2G.分表分库话题"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><span class="icon iconfont icon-tree"></span>2G.分表分库话题</div></a><a href="/2-faceless/2i-prop-faceless.html" class="nav-link next" aria-label="2I.虚空的属性"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">2I.虚空的属性<span class="icon iconfont icon-enum"></span></div></a></nav><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Apache2 licensed, Vuepress-Theme-Hope powered</div><div class="copyright">Copyright© trydofor</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.f1aca755.js" defer></script>
  </body>
</html>
