import{_ as o}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as p,c as l,b as n,e as a,d as s,f as t}from"./app-7d38ae22.js";const c={},r=t(`<h1 id="_0e-config-topic" tabindex="-1"><a class="header-anchor" href="#_0e-config-topic" aria-hidden="true">#</a> 0E.Config Topic</h1><p>Project configuration, such as maven, properties, spring and other settings.</p><h2 id="_0e-01-which-config-must-be-enabled" tabindex="-1"><a class="header-anchor" href="#_0e-01-which-config-must-be-enabled" aria-hidden="true">#</a> 0E.01.Which Config Must Be Enabled</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># find all enabled properties files</span>
<span class="token function">find</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-name</span> <span class="token string">&#39;spring-wings-enabled.properties&#39;</span> <span class="token punctuation">\\</span>
<span class="token operator">|</span> <span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-E</span> <span class="token string">&#39;target/|example/&#39;</span> 

./slardar/src/main/resources/wings-conf/spring-wings-enabled.properties
./faceless/src/main/resources/wings-conf/spring-wings-enabled.properties
./silencer/src/main/resources/wings-conf/spring-wings-enabled.properties

<span class="token comment"># find all disabled flag</span>
<span class="token function">find</span> <span class="token builtin class-name">.</span> <span class="token parameter variable">-name</span> <span class="token string">&#39;spring-wings-enabled.properties&#39;</span> <span class="token punctuation">\\</span>
<span class="token operator">|</span> <span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-E</span> <span class="token string">&#39;target/|example/&#39;</span> <span class="token punctuation">\\</span>
<span class="token operator">|</span> <span class="token function">xargs</span> <span class="token function">grep</span> <span class="token string">&#39;false&#39;</span>

<span class="token comment"># enalbe the following 2 if need flywave and enum features</span>
<span class="token assign-left variable">spring.wings.faceless.flywave.enabled.module</span><span class="token operator">=</span>false
<span class="token assign-left variable">spring.wings.faceless.enabled.enumi18n</span><span class="token operator">=</span>false
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_0e-02-customize-springboot-version-and-dependency" tabindex="-1"><a class="header-anchor" href="#_0e-02-customize-springboot-version-and-dependency" aria-hidden="true">#</a> 0E.02.Customize Springboot version and dependency</h2><p>Wings only handles the loading of configuration files, in the SpringBoot standard lifecycle, without relying on a specific version. For those who do not want to follow along with wings to upgrade spring and its dependencies, just make wings as a dependency, not a parent and import.</p><p>Wings always follows the upgrade to the next level stable version of SpringBoot for the purpose of testing sharding-jdbc and jooq compatibility. And for binary compatibility, wings version 210 is compiled with a target of java=11, kotlin=1.6</p><p>For maven inheritance dependencies there are parent and import two, the important difference is the property override.</p>`,8),d=n("li",null,"parent - you can also override individual dependencies by overriding a property in your own project",-1),u=n("li",null,"import - does not let you override individual dependencies by using properties, as explained above. To achieve the same result, you need to add entries in the dependencyManagement section of your project before the spring-boot-dependencies entry.",-1),g={href:"https://docs.spring.io/spring-boot/docs/3.0.3/maven-plugin/reference/htmlsingle/#using.parent-pom",target:"_blank",rel:"noopener noreferrer"},k={href:"https://docs.spring.io/spring-boot/docs/3.0.3/maven-plugin/reference/htmlsingle/#using-import",target:"_blank",rel:"noopener noreferrer"},m=t(`<p>For spring-boot versions lower than wings, generally, specify the jooq version to completely work.</p><h2 id="_0e-03-the-difference-between-lib-and-boot-projects" tabindex="-1"><a class="header-anchor" href="#_0e-03-the-difference-between-lib-and-boot-projects" aria-hidden="true">#</a> 0E.03.The Difference Between Lib and Boot projects</h2><p>The SpringBoot package executable boot.jar, not the normal lib.jar</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executable</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executable</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>For the lib project configuration, skip the <code>repackage</code> and refer to the example project.</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>repackage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>repackage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>skip</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>skip</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Wings recommended project structure is the <code>project/build/plugins</code> entry in the parent&#39;s pom.xml. Default settings for <code>configuration</code> of the following <code>plugin</code>.</p><ul><li>spring-boot-maven-plugin - executable=true</li><li>maven-deploy-plugin - skip=true</li><li>maven-install-plugin - skip=true</li></ul><p>In this way, all submodules, with boot project provide default build (boot packing, no deploy, no install). Skip boot packaging in the lib submodule, ie. skip=true in repackage.</p><h2 id="_0e-04-missing-mirana-and-meepo-dependency" tabindex="-1"><a class="header-anchor" href="#_0e-04-missing-mirana-and-meepo-dependency" aria-hidden="true">#</a> 0E.04.Missing Mirana and Meepo dependency</h2><p>Due to The Big Wing Project for Non-Foodies (once named), some <code>SNAPSHOT</code> dependencies need to be compiled and installed locally by yourself. Occasionally can be found on <code>sonatype</code>, you need to add your own <code>repository</code>, such as <code>~/.m2/settings.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>repository</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>ossrh-snapshots<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>https://oss.sonatype.org/content/repositories/snapshots<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>snapshots</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>snapshots</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>releases</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>enabled</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>enabled</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>releases</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>repository</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_0e-05-placeholder-for-config-and-inject" tabindex="-1"><a class="header-anchor" href="#_0e-05-placeholder-for-config-and-inject" aria-hidden="true">#</a> 0E.05.Placeholder for Config and Inject</h2><ul><li>In Hard code, @Autowired <ul><li>PropertyResolver - Get or parse a string value by key</li><li>StringValueResolver - parse a value string</li></ul></li><li>In properties, use <code>\${VAR}</code></li><li>In @Value and @RequestMapping, use <code>\${VAR}</code></li></ul><h2 id="_0e-06-removing-tomcat-or-hazelcast" tabindex="-1"><a class="header-anchor" href="#_0e-06-removing-tomcat-or-hazelcast" aria-hidden="true">#</a> 0E.06.Removing Tomcat or Hazelcast</h2><p>When using wings as a parent through dependencyManagement, the default inheritance of wings does not need to be changed. However, if you donot inherit the wings, the following two items may be changed by yourself depending on the situation.</p><ul><li>spring-boot-starter-web/spring-boot-starter-tomcat, because the default use of undertow</li><li>spring-session-hazelcast/hazelcast, use the latest version</li></ul><h2 id="_0e-07-java-and-kotlin-version" tabindex="-1"><a class="header-anchor" href="#_0e-07-java-and-kotlin-version" aria-hidden="true">#</a> 0E.07.Java and Kotlin Version</h2><p>Set the compilation version of java and kotlin by pom, if there is compilation failure in IDE, it is likely that the compilation version is not correct. Since 210, wings is fully adapted to java 11, kotlin is automatically updated to 1.6, but no java8 certificate compatibility test is done.</p><h2 id="_0e-08-config-logger-and-log-groups" tabindex="-1"><a class="header-anchor" href="#_0e-08-config-logger-and-log-groups" aria-hidden="true">#</a> 0E.08.Config logger and log groups</h2>`,20),h={href:"https://docs.spring.io/spring-boot/docs/3.0.3/reference/htmlsingle/#features.logging.log-groups",target:"_blank",rel:"noopener noreferrer"},v=t(`<ul><li>org.springframework.core.codec</li><li>org.springframework.http</li><li>org.springframework.web</li><li>org.springframework.boot.actuate.endpoint.web</li><li>org.springframework.boot.web.servlet.ServletContextInitializerBeans</li><li>org.springframework.jdbc.core</li><li>org.jooq.tools.LoggerListener</li></ul><blockquote><p>Spring Boot uses Commons Logging for all internal logging but leaves the underlying log implementation open</p></blockquote><p>Wings follows this practice, <code>@Configuration</code> and other spring feature use CommonsLogging, And the business code using lombok <code>@Slf4j</code> configured as <code>static</code> <code>log</code></p><h2 id="_0e-09-mvn-resources-filtering" tabindex="-1"><a class="header-anchor" href="#_0e-09-mvn-resources-filtering" aria-hidden="true">#</a> 0E.09.Mvn Resources Filtering</h2><p>Note: After version 210, the mvn variable is replaced by the spring variable and the filter is no longer needed.</p><p>Because the variable <code>@project.version@</code> is used in the swagger configuration, it will be configured build/resources/resource/filtering=true so that mvn replaces it automatically.</p><p>However, enabling filter can cause replacement to fail, such as binary files, and wings ignores some binaries by default.</p><h2 id="_0e-10-spa-and-reverse-proxy-cache-cettings" tabindex="-1"><a class="header-anchor" href="#_0e-10-spa-and-reverse-proxy-cache-cettings" aria-hidden="true">#</a> 0E.10.SPA and Reverse Proxy Cache Cettings</h2><p>By default, Springboot automatically adds the following Response Header, <code>Cache-Control</code>=<code>no-cache,no-store,max-age=0,must-revalidate</code> so that the reverse proxy does not need to be set. However, for SPA pages, manual settings are required, such as nginx configuration.</p><div class="language-nginx line-numbers-mode" data-ext="nginx"><pre class="language-nginx"><code><span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span>
    <span class="token comment">#add_header &#39;Access-Control-Allow-Origin&#39; &#39;*&#39;; #CORS</span>
    <span class="token directive"><span class="token keyword">root</span> /data/static/demo-admin-spa/</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_filename</span> ~* \\.(html|htm)$)</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">add_header</span> Cache-Control no-cache,no-store,max-age=0,must-revalidate</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_0e-11-how-to-ignore-a-config-entry" tabindex="-1"><a class="header-anchor" href="#_0e-11-how-to-ignore-a-config-entry" aria-hidden="true">#</a> 0E.11.How to Ignore a Config Entry</h2><p>In wings principle, the config entry must have default value, and sometimes the default key or value need to be ignored.</p><ul><li><code>String</code> invalid value - <code>empty</code> or <code>-</code> is the default invalid value</li><li><code>Map&lt;String, String&gt;</code> - the value of the invalid key</li><li><code>Map&lt;String, Set&lt;String&gt;&gt;</code> - the value of overrided key</li></ul><h2 id="_0e-12-execution-order-in-spring" tabindex="-1"><a class="header-anchor" href="#_0e-12-execution-order-in-spring" aria-hidden="true">#</a> 0E.12.Execution Order in Spring</h2>`,14),f=n("code",null,"spring.facts",-1),b={href:"https://docs.spring.io/spring-boot/docs/3.0.3/reference/htmlsingle/#features.spring-application.application-events-and-listeners",target:"_blank",rel:"noopener noreferrer"},y=t('<ul><li>ApplicationEnvironmentPreparedEvent(spring.factories)</li><li>ApplicationContextInitializedEvent(spring.factories)</li><li>ApplicationPreparedEvent(spring.factories)</li><li>Constructor - constructor are executed first</li><li>@Autowired - dependency injection</li><li>@PostConstruct - executed after dependency injection, no parameters</li><li>afterPropertiesSet - InitializingBean interface</li><li>@Bean - On-demand or sequential execution</li><li>ContextRefreshedEvent(spring.factories)</li><li>ApplicationStartedEvent - Started, event parameter</li><li>CommandLineRunner - Runner, injected dependencies</li><li>ApplicationReadyEvent - Ready, event parameter</li></ul><p>The common configuration methods and order in Wings are as follows.</p><ul><li>Constructor - global, required dependency, injected as a final by constructor</li><li>@Autowired - local, optional dependency, injected as a setter</li><li>@PostConstruct - Executes the end of the current configuration, without parameters.</li><li>ApplicationStartedEventRunner - before app/cmd runners initialize Helper</li><li>ApplicationRunnerOrdered - custom ordered ApplicationRunner</li><li>CommandLineRunnerOrdered - custom ordered CommandLineRunner</li><li>ApplicationInspectRunner - LOWEST_PRECEDENCE ApplicationRunner</li><li>ApplicationReadyEventRunner - after app/cmd runners called</li></ul><p>Helper will be initialized when ApplicationStartedEvent. configuration and common beans are defined by constants</p><ul><li>WingsBeanNaming - name of important bean</li><li>WingsBeanOrdered - Order and cascading</li></ul><h2 id="_0e-13-log-format-in-spring-config" tabindex="-1"><a class="header-anchor" href="#_0e-13-log-format-in-spring-config" aria-hidden="true">#</a> 0E.13.Log Format in Spring Config</h2><p>In Configuration&#39;s CommonsLogging, the log follows the following common log.info format</p><ul><li><code>@Bean</code> - {ModuleName} spring-bean {BeanName}</li><li><code>@Autowired</code> - {ModuleName} spring-auto {MethodName}</li><li><code>@PostConstruct</code> - {ModuleName} spring-auto {MethodName}</li><li><code>CommandLineRunner</code> - {ModuleName} spring-runs {BeanName}</li><li><code>Bean*PostProcessor</code> - {ModuleName} spring-proc {BeanName}</li><li>Process log - {ModuleName} conf</li></ul>',8);function w(_,x){const e=i("ExternalLinkIcon");return p(),l("div",null,[r,n("ul",null,[d,u,n("li",null,[n("a",g,[a("https://docs.spring.io/spring-boot/docs/3.0.3/maven-plugin/reference/htmlsingle/#using.parent-pom"),s(e)])]),n("li",null,[n("a",k,[a("https://docs.spring.io/spring-boot/docs/3.0.3/maven-plugin/reference/htmlsingle/#using-import"),s(e)])])]),m,n("p",null,[a("SpringBoot built-in "),n("a",h,[a("Log Groups"),s(e)])]),v,n("p",null,[a("In the Spring lifecycle, using @Configuration as an example, the following order of execution is as follows, where "),f,a(" means spring boot "),n("a",b,[a("lifecirle events"),s(e)])]),y])}const j=o(c,[["render",w],["__file","0e-qa-config.html.vue"]]);export{j as default};
