import{_ as d}from"./plugin-vue_export-helper.21dcd24c.js";import{r as t,o as c,c as s,a as e,b as n,d as l,e as o}from"./app.c6e7f883.js";const i={},r=l(`<h1 id="_2b-\u65F6\u95F4\u6F2B\u6E38" tabindex="-1"><a class="header-anchor" href="#_2b-\u65F6\u95F4\u6F2B\u6E38" aria-hidden="true">#</a> 2B.\u65F6\u95F4\u6F2B\u6E38</h1><p>\u51B2\u5230\u76EE\u6807\u4F4D\u7F6E\uFF0C\u5E76\u53D6\u6D88\u6700\u8FD12.0\u79D2\u5185\u53D7\u5230\u7684\u4EFB\u4F55\u4F24\u5BB3\u3002 \u865A\u7A7A\u5047\u9762\u5728\u65F6\u95F4\u6F2B\u6E38\u8FC7\u7A0B\u4E2D\u4E3A\u65E0\u654C\u72B6\u6001\u3002</p><ul><li>\u4ECE\u6570\u636E\u5E93\u81EA\u52A8\u751F\u6210jooq\u4EE3\u7801\uFF0Cpojo, table, dao</li><li>\u901A\u8FC7jooq\u7684\u5F3A\u7C7B\u578B\uFF0C\u4FDD\u8BC1\u6570\u636E\u5C42\u9762\u7684\u53D8\u66F4\u548C\u91CD\u6784\u7A33\u5B9A</li></ul><h2 id="_2b-1-\u5F3A\u7C7B\u578B\u7684\u6570\u636E\u5E93\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#_2b-1-\u5F3A\u7C7B\u578B\u7684\u6570\u636E\u5E93\u64CD\u4F5C" aria-hidden="true">#</a> 2B.1.\u5F3A\u7C7B\u578B\u7684\u6570\u636E\u5E93\u64CD\u4F5C</h2><p>\u63A8\u8350\u4F7F\u7528SqlMapping\uFF0C\u56E0\u4E3AORM\u592A\u91CD\u4E86\uFF0C\u5DE5\u7A0B\u5185\u4F7F\u7528Jooq\u548CJdbcTemplate</p><p>MyBatis\u867D\u662F\u5927\u90E8\u5206\u9879\u76EE\u7684\u9996\u9009\uFF0C\u56FA\u6709\u5176\u4F18\u79C0\u4E4B\u5904\uFF0C\u4F46\u5F00\u53D1\u4EBA\u5458\u7684\u61D2\u60F0\u6216\u7EA6\u675F\u529B\u91CF\u7684\u4E0D\u8DB3\uFF0C \u4F7F\u5F97\u9879\u76EE\u4E0D\u9AD8\u6548\uFF0C\u5076\u5C14\u5F88\u96BE\u7EF4\u62A4\uFF0C\u9879\u76EE\u4E2D\u5BB9\u6613\u8513\u751F\u51FA\u4EE5\u4E0B\u95EE\u9898\u3002</p><ul><li>\u7ECF\u5E38\u88AB <code>select *</code>\uFF0C\u5E26\u6709\u5927\u91CF\u65E0\u7528\u4FE1\u606F\u3002</li><li>\u5F88\u5BB9\u6613\u5199\u51FA\u590D\u6742\u7684\u5927SQL\uFF0C\u4F7F\u5F97\u670D\u52A1\u96BE\u4EE5\u62C6\u5206\u3002</li><li>\u5B57\u7B26\u4E32\u53CA\u5F31\u7C7B\u578B\uFF0CIDE\u7684\u7737\u987E\u6709\u9650\u3002</li></ul><p>\u4F7F\u7528Jooq\uFF0C\u5F3A\u7C7B\u578B\uFF0C\u7F16\u7A0B\u9AD8\u4E8E\u914D\u7F6E\uFF0C\u5E76\u4E14SQL\u53CB\u597D\uFF0C\u53C8\u6070\u597D\u6709\u9650\u5236\u80FD\u529B\u7684\u80FD\u529B\u3002</p><p>\u81EA\u52A8\u751F\u6210jooq\u4EE3\u7801\uFF0C\u4F7F\u7528<code>WingsCodeGenerator</code>\u4EE5\u7F16\u7A0B\u7684\u65B9\u5F0F\u8FDB\u884C\uFF08\u4E0D\u7528maven\uFF09\u3002 \u81EA\u52A8\u751F\u6210\u7684\u4EE3\u7801\u5728 <code>database/autogen/</code>\uFF0C\u624B\u52A8\u7F16\u5199\u7684\u4EE3\u7801\u5728<code>database/manual/</code>\u4E0B\u3002</p><p>\u5F53\u81EA\u52A8\u751F\u6210\u4EE3\u7801\u65F6\u78B0\u5230wings\u6216jooq\u65AD\u7248\u529F\u80FD\u5BFC\u81F4\u7F16\u8BD1\u9519\u8BEF\uFF0C\u65E0\u6CD5\u5728\u5F53\u524D\u5DE5\u7A0B\u751F\u4EA7\u4EE3\u7801\u65F6\uFF0C \u9700\u8981\u5EFA\u7ACB\u4E00\u4E2A\u65B0\u7684\u5C0F\u5DE5\u7A0B\uFF0C\u4F9D\u8D56wings\u65B0\u7248\uFF0C\u7136\u540E\u6267\u884C\u4EE3\u7801\u751F\u6210\u7C7B\u5373\u53EF\u3002</p><p>\u81EA\u52A8\u751F\u6210\u7684<code>*Dao</code>\uFF0C\u6709\u5927\u91CF\u53EF\u76F4\u63A5\u4F7F\u7528\u7684\u6570\u636E\u5E93\u64CD\u4F5C\u65B9\u6CD5\uFF0C\u514D\u53BB\u5F88\u591A\u624B\u5199\u4EE3\u7801\u91CF\u3002</p><ul><li><code>getAlias</code> \u83B7\u5F97select\u7528\u7684\u522B\u540D\u8868\uFF0C<code>Table as az</code><ul><li>\u8FD0\u884C\u65F6\uFF0CTable\u552F\u4E00\uFF0C\u91C7\u7528excel\u683C\u5F0F\u7684az\u8FDB\u5236\u8868\u793A</li><li>\u81EA\u547D\u540D\u65F6\uFF0C\u91C7\u7528\u6570\u5B57\u7ED3\u5C3E\uFF0C\u907F\u514D\u4E0E\u7CFB\u7EDF\u53D1\u751F\u51B2\u7A81\u3002</li></ul></li><li><code>getTable</code> \u83B7\u5F97modify\u7528\u7684\u4E0D\u4F7F\u7528\u522B\u540D\u7684\u8868 <code>Table</code></li><li>\u4F7F\u7528preparedStatement\u7684batch\u6279\u91CF\u63D2\u5165\u548C\u66F4\u65B0\u5927\u91CF\u6570\u636E</li><li>\u4F7F\u7528mysql\u7279\u6548\uFF0C<code>insert ignore</code>\u548C<code>replace into</code>\u5904\u7406\u91CD\u590D\u6570\u636E</li><li>\u4F7F\u7528<code>on duplicate key update</code>\u6216<code>select+insert+update</code>\u90E8\u5206\u66F4\u65B0\u552F\u4E00\u8BB0\u5F55\u3002</li></ul><p>\u503C\u5F97\u6CE8\u610F\u7684\u662F\uFF0C\u5728Dao\u4E2D\u4F7F\u7528alias\u8868\u548C\u672C\u8868\u65F6\uFF0C\u5FC5\u987B\u4FDD\u6301\u540C\u6E90\uFF0C\u5426\u5219\u62A5\u8BED\u6CD5\u9519\u8BEF\u3002</p><div class="language-kotlin ext-kt line-numbers-mode"><pre class="language-kotlin"><code><span class="token keyword">val</span> da <span class="token operator">=</span> dao<span class="token punctuation">.</span>alias
<span class="token comment">// val rd = dao.fetch(da.Id.eq(id)) \u522B\u540D\u548C\u672C\u8868\u4E0D\u540C\u6E90\uFF0C\u8BED\u6CD5\u9519\u8BEF</span>
<span class="token comment">// select * from win_user where \`y8\`.\`id\` = ?</span>

<span class="token keyword">val</span> rd <span class="token operator">=</span> dao<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>da<span class="token punctuation">,</span> da<span class="token punctuation">.</span>Id<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u590D\u6742\u6570\u636E\u64CD\u4F5C\u5FC5\u987B\u624B\u5199\u4EE3\u7801\u65F6\uFF0C\u9075\u5FAA\u4EE5\u4E0B\u7EA6\u5B9A\uFF0C</p><ul><li>\u4EFB\u4F55\u5BF9\u6570\u636E\u5E93\u7684\u64CD\u4F5C\uFF0C\u90FD\u5E94\u8BE5\u5728<code>database</code>\u5305\u5185\u8FDB\u884C\u3002</li><li>DSLContext\u548CDataSource\u4E0D\u5E94\u8BE5\u79BB\u5F00database\u5C42\u3002</li><li><code>single/</code>\u5305\uFF0C\u8868\u793A\u5355\u8868\uFF0C\u53EF\u542B\u7B80\u5355\u7684\u6761\u4EF6\u5B50\u67E5\u8BE2\uFF0C\u4E00\u4E2A\u5305\u540D\u4E00\u4E2A\u8868\u3002</li><li><code>couple/</code>\u5305\uFF0C \u8868\u793A\u591A\u8868\uFF0C\u4E00\u822C\u4E3Ajoin\u67E5\u8BE2\u6216\u5B50\u67E5\u8BE2\uFF0C\u5305\u540D\u4EE5\u4E3B\u8868\u547D\u540D\u3002</li><li><code>select|modify</code>\u5206\u522B\u5BF9\u5E94\u6570\u636E\u5E93\u64CD\u4F5C\u3002</li><li>\u4E5F\u53EF\u4EE5<code>select|insert|update|delete</code>\u5206\u7C7B\uFF0C\u53EA\u662Fautowired\u65F6\u6BD4\u8F83\u591A</li><li>\u6570\u636E\u4F20\u9012\u4EE5Dto\u7ED3\u5C3E\uFF0C\u653E\u5230\u6700\u4E34\u8FD1\u4F7F\u7528\u7684\u4F4D\u5B50\u3002</li><li>Dto\u4EE5\u9759\u6001\u5185\u7C7B\u5F62\u4F3C\u5B58\u5728\uFF0C\u7528lombok\u505A@Value\u6216@Data\u3002</li><li><code>forUpdate</code>\u8FD9\u79CD\u5E26\u9501\u64CD\u4F5C\uFF0C\u65B9\u6CD5\u540D\u4EE5<code>Lock</code>\u7ED3\u5C3E\u3002</li><li>\u7C7B\u540D\u4EE5<code>\u8868\u540D</code>+<code>Insert|Modify</code>\u3002</li><li><code>Record</code>\u7B49\u540C\u4E8E<code>Dao</code>\u4E0D\u5E94\u8BE5\u5728\u5916\u90E8\u4F7F\u7528\uFF0C\u5E94\u8BE5\u7528<code>Pojo</code>\u6216<code>Dto</code></li><li>\u4E3B\u8981 Dao\uFF0C\u5B8C\u6210 dsl\uFF0C\u7B49\u76F8\u5173\u64CD\u4F5C\u5373\u53EF</li></ul><p>JdbcTemplate\u7528\u4E8E\u529F\u80FD\u6027\u6216\u590D\u6742\u7684\u6570\u636E\u5E93\u64CD\u4F5C\uFF0C\u4EE5\u81EA\u52A8\u6CE8\u5165Bean\u3002 \u53C2\u8003 <code>JdbcTemplateConfiguration</code>\u7684\u6CE8\u5165\u3002</p><p>\u547D\u540D\u4E0A\uFF0C\u63A5\u53E3\u76F4\u63A5\u547D\u540D\uFF0C\u4E0D\u9700\u8981\u524D\u540E\u7F00\uFF0CDto\u653E\u5728\u63A5\u53E3\u4E4B\u5185\u3002 \u5B9E\u73B0\u7C7B\uFF0C\u653E\u5230<code>impl/</code>\u5305\u5185\uFF0C\u7528\u540E\u7F00\u8868\u793A\u5B9E\u73B0\u65B9\u5F0F\u4E0D\u540C\u3002</p><ul><li><code>Jooq</code>\uFF0CJooq\u5B9E\u73B0</li><li><code>Jdbc</code>\uFF0CJdbcTemplate\u5B9E\u73B0</li><li><code>Impl</code>\uFF0C\u6DF7\u5408\u5B9E\u73B0\u3002</li></ul><p>\u5982<code>LightId</code>\u5728\u8BFB\u5199\u5206\u79BB\u65F6\uFF0C\u9700\u8981\u5F3A\u5236master\uFF0C\u53EF\u4F7F\u7528\u6CE8\u89E3<code>MasterRouteOnly</code>\u3002</p><h2 id="_2b-2-sharding\u7684\u517C\u5BB9\u95EE\u9898" tabindex="-1"><a class="header-anchor" href="#_2b-2-sharding\u7684\u517C\u5BB9\u95EE\u9898" aria-hidden="true">#</a> 2B.2.Sharding\u7684\u517C\u5BB9\u95EE\u9898</h2><p><code>flywave</code>\u5BF9jooq\u7684<code>Dao</code>\u5305\u88C5\uFF0C\u63D0\u4F9B\u4E86<code>reader</code>\u548C<code>writer</code>\u8868\uFF0C\u8DDF\u8E2A\u8868\u3002 \u56E0\u6B64\uFF0C\u5F3A\u70C8\u5EFA\u8BAE\uFF0C\u4F7F\u7528<code>Dao</code>\u5B8C\u6210\u57FA\u7840\u7684CRUD\u64CD\u4F5C\uFF0C\u53C2\u89C1<code>JooqShardingTest.kt</code>\u3002 \u4F7F\u7528dsl\u6784\u9020\u590D\u6742\u7684sql\u65F6\uFF0C\u8981\u8003\u8651\u8BFB\u5199\u5206\u79BB\u3002\u66F4\u590D\u6742\u7684sql\u5EFA\u8BAE\u4F7F\u7528jdbcTemplate\u3002</p><p>jooq\u751F\u6210\u4EE3\u7801\uFF0C\u9ED8\u8BA4\u4F7F\u7528<code>table.column</code>\u9650\u5B9A\u5217\u540D\uFF0C\u800CShardingJdbc\u505A\u5F53\u524D\u7248\u672C\u4E0D\u652F\u6301\u3002 \u6700\u4F18\u89E3\u51B3\u529E\u6CD5\u662F\u4F7FShardingJdbc\u652F\u6301\uFF0C\u5F53\u524D\u6700\u7B80\u5355\u7684\u529E\u6CD5\u662F\u4FEE\u6539Jooq\u751F\u6210\u7B56\u7565\uFF0C\u53C2\u8003\u4EE5\u4E0BIssue\u3002</p>`,23),p={href:"https://github.com/jOOQ/jOOQ/issues/8893",target:"_blank",rel:"noopener noreferrer"},u=o("JOOQ#8893 Add Settings.renderTable"),h={href:"https://github.com/jOOQ/jOOQ/pull/9055",target:"_blank",rel:"noopener noreferrer"},_=o("JOOQ#9055 should NO table qualify if NO table alias"),b={href:"https://github.com/apache/incubator-shardingsphere/issues/2859",target:"_blank",rel:"noopener noreferrer"},g=o("ShardingSphere#2859 "),m=e("code",null,"table.column",-1),f=o(" can not sharding"),k={href:"https://github.com/apache/shardingsphere/issues/5330",target:"_blank",rel:"noopener noreferrer"},q=o("ShardingSphere#5330 replace into"),j={href:"https://github.com/apache/shardingsphere/issues/5210",target:"_blank",rel:"noopener noreferrer"},S=o("ShardingSphere#5210 on duplicate key update"),w=l('<p>\u5728jooq<code>3.17.0</code>\u7248\u672C\u4E4B\u524D\uFF0C\u4F7F\u7528<code>spring.wings.faceless.jooq.enabled.auto-qualify=true</code>\uFF0C \u5B8C\u6210\u9650\u5B9A\u540D\u7684\u81EA\u52A8\u5904\u7406\uFF0C\u5176\u89C4\u5219\u662F\uFF0C<code>\u4E0D\u5B58\u5728alias\u65F6\uFF0C\u4E0D\u589E\u52A0\u9650\u5B9A\u540D</code>\u3002</p><p>\u4F7F\u7528Jooq\u7684\u4E3B\u8981\u539F\u56E0\u4E4B\u4E00\u662F<code>\u9650\u5236\u7684\u827A\u672F</code>\uFF0C\u907F\u514D\u5199\u51FA\u6BD4\u8F83\u590D\u6742\u7684SQL\uFF0C\u6240\u4EE5\u7EA6\u5B9A\u5982\u4E0B\uFF0C</p><ul><li>\u9F13\u52B1\u5355\u8868\u64CD\u4F5C\uFF0C\u653E\u5728<code>single</code>\u5305\u5185\uFF0C\u4F7F\u7528<code>\u672C\u540D</code>(\u5982\uFF0CWinUserLoginTable)</li><li>\u64CD\u4F5C\u591A\u8868\u65F6\uFF0C<code>\u522B\u540D</code>(\u5982\uFF0CWinUserLoginTable.asA2)\u4F18\u4E8E<code>\u672C\u540D</code></li><li>INSERT \u4F7F\u7528<code>\u672C\u540D</code>\uFF0C\u4E0D\u53EF\u4F7F\u7528<code>\u522B\u540D</code></li><li>DELETE \u4F7F\u7528<code>\u672C\u540D</code>\uFF0C\u4E0D\u53EF\u4F7F\u7528<code>\u522B\u540D</code></li><li>UPDATE \u4F7F\u7528<code>\u522B\u540D</code>\u4F18\u5148\u4E8E<code>\u672C\u540D</code></li><li>SELECT \u5355\u8868\u65F6\uFF0C\u7528<code>\u672C\u540D</code>\uFF1B\u591A\u8868\u65F6\uFF0C<code>\u522B\u540D</code>\u4F18\u5148\u4E8E<code>\u672C\u540D</code></li><li><strong>\u4E0D\u8981</strong> \u4F7F\u7528\u4E2D\u6587\u8868\u540D\uFF0C\u4F8B\u5B50\u4EE3\u7801\u53EA\u662F\u6781\u7AEF\u6D4B\u8BD5\u3002</li></ul><h2 id="_2b-3-record-mapper" tabindex="-1"><a class="header-anchor" href="#_2b-3-record-mapper" aria-hidden="true">#</a> 2B.3.Record Mapper</h2><p>jooq \u9ED8\u8BA4\u67092\u4E2DMapper\u90FD\u533A\u5206\u5927\u5C0F\u5199\uFF0C\u5BF9\u5E94\u7684\u529F\u80FD\u5982\u4E0B</p><ul><li>DefaultRecordMapper \u8D1F\u8D23Record#into(Class), Result#into(Class)</li><li>DefaultRecordUnmapper \u8D1F\u8D23DSL.newRecord(Table, Object), Record#from(Object)</li></ul><p>SimpleFlatMapper\u7684mapper\u66F4\u4E3A\u5BBD\u677E\uFF0C\u4E0D\u533A\u5206\u5927\u5C0F\u5199\uFF0C\u5355\u6709\u4E00\u4E0B\u4E0D\u8DB3\u3002</p>',7),v={href:"https://github.com/arnaudroger/SimpleFlatMapper/issues/764",target:"_blank",rel:"noopener noreferrer"},x=o("intoArray\u7684bug"),D=e("li",null,"\u4E0D\u652F\u6301primary type\uFF0C\u5982int.class\uFF0C\u4EC5Integer.class",-1),O=e("p",null,"\u5728\u5B98\u65B9\u4FEE\u590D\u524D\uFF0C\u4E0D\u63A8\u8350\u4F7F\u7528\uFF0C\u56E0\u4E3A\u9664\u4E86\u4EE5\u4E0Abug\uFF0C\u5E76\u672A\u5145\u5206\u6D4B\u8BD5\u3002",-1),T=e("h2",{id:"_2b-4-\u53C2\u8003\u8D44\u6599",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_2b-4-\u53C2\u8003\u8D44\u6599","aria-hidden":"true"},"#"),o(" 2B.4.\u53C2\u8003\u8D44\u6599")],-1),y={href:"https://github.com/trydofor/jOOQ/commit/0be23d2e90a1196def8916b9625fbe2ebffd4753",target:"_blank",rel:"noopener noreferrer"},J=o("Jooq patch"),L={href:"https://www.jooq.org/doc/3.12/manual/sql-execution/crud-with-updatablerecords/batch-execution-for-crud/",target:"_blank",rel:"noopener noreferrer"},R=o("\u6279\u91CF\u64CD\u4F5C record"),E={href:"https://www.jooq.org/doc/3.12/manual/sql-execution/batch-execution/",target:"_blank",rel:"noopener noreferrer"},I=o("\u6279\u91CF\u64CD\u4F5C jdbc"),Q={href:"https://www.jooq.org/doc/3.12/manual/sql-building/table-expressions/aliased-tables/",target:"_blank",rel:"noopener noreferrer"},B=o("\u4F7F\u7528\u522B\u540D\uFF0C\u652F\u6301\u5206\u8868"),M={href:"https://www.jooq.org/doc/3.12/manual/sql-execution/",target:"_blank",rel:"noopener noreferrer"},C=o("SQL\u7684\u6267\u884C");function N(U,A){const a=t("ExternalLinkIcon");return c(),s("div",null,[r,e("ul",null,[e("li",null,[e("a",p,[u,n(a)])]),e("li",null,[e("a",h,[_,n(a)])]),e("li",null,[e("a",b,[g,m,f,n(a)])]),e("li",null,[e("a",k,[q,n(a)])]),e("li",null,[e("a",j,[S,n(a)])])]),w,e("ul",null,[e("li",null,[e("a",v,[x,n(a)])]),D]),O,T,e("ul",null,[e("li",null,[e("a",y,[J,n(a)])]),e("li",null,[e("a",L,[R,n(a)])]),e("li",null,[e("a",E,[I,n(a)])]),e("li",null,[e("a",Q,[B,n(a)])]),e("li",null,[e("a",M,[C,n(a)])])])])}var z=d(i,[["render",N],["__file","2b-jooq.html.vue"]]);export{z as default};
