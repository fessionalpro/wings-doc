import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,b as i,o as n}from"./app-B3mmVXA7.js";const l={};function r(o,a){return n(),t("div",null,[...a[0]||(a[0]=[i('<h1 id="_8a-小任务模块" tabindex="-1"><a class="header-anchor" href="#_8a-小任务模块"><span>8A.小任务模块</span></a></h1><p>基于Spring Schedule提供了以database为中心的任务调度</p><ul><li>自动发现和执行</li><li>中途取消，启动，修改配置</li><li>设置任务通知</li><li>查询任务执行历史</li></ul><h2 id="_8a-1-设计要求" tabindex="-1"><a class="header-anchor" href="#_8a-1-设计要求"><span>8A.1.设计要求</span></a></h2><p>TinyTask设计为强类型，静态的，因此默认限制了动态添加任务。</p><ul><li>任务对象必须是SpringBean</li><li>使用@TinyTask.Auto注解的类可自动发现</li><li>入口方法必须使用@TinyTask注解标注</li><li>通过配置文件设置任务属性</li><li>最终配置以database为准，除非version覆盖</li><li>任务仅在限定的app和run mode中启动</li><li>任务自身可进行并发控制(Jvm及Database)</li></ul><h2 id="_8a-2-配置覆盖" tabindex="-1"><a class="header-anchor" href="#_8a-2-配置覆盖"><span>8A.2.配置覆盖</span></a></h2><p>任务可自动或手动添加，以@TinyTask.Auto注解的Bean会自动开始， 此外，通过TinyTaskService.schedule方法手动开始。</p><p>任务的配置会首先进行合并，优先级为从高到低依次为。</p><ul><li>任务自身key的属性值</li><li>任务的default值</li><li>annotation注解值</li></ul><p>以上合并后的配置文件，成为tasks的property，会和database中当前值比较version 以version大者优先，相等时，以database（win_task_define表）优先。</p><h2 id="_8a-3-任务调度" tabindex="-1"><a class="header-anchor" href="#_8a-3-任务调度"><span>8A.3.任务调度</span></a></h2><p>任务按执行时间，分为<code>fast</code>和<code>@Scheduled</code>默认任务，对应2个的线程池。 一般任务秒级完成的为轻任务，在fast线程池中执行，否则为默认任务。</p><p>一个任务必须设置cron/idle/rate中任意一个值，以进行任务调度， 如果同时设置，则cron高于idle，idle高于rate覆盖。</p><h2 id="_8a-4-任务控制" tabindex="-1"><a class="header-anchor" href="#_8a-4-任务控制"><span>8A.4.任务控制</span></a></h2><p>TinyTask默认提供了控制的Controller</p><ul><li>task-running - 运行中的任务列表</li><li>task-defined - 定义的任务列表</li><li>task-result - 任务历史列表</li><li>task-cancel - 取消一个任务</li><li>task-launch - 启动任务</li><li>task-force - 强制执行任务</li><li>task-enable - 启动或禁用任务</li><li>task-prop-save - 更新任务配置</li><li>task-prop-load - 任务载入属性</li><li>task-prop-conf - 任务配置属性</li><li>task-prop-diff - 任务属性差异</li></ul><p>推荐在编码中进行任务控制，比较安全和强类型</p><ul><li>TinyTaskConfService - 配置相关服务</li><li>TinyTaskExecService - 执行相关服务</li><li>TinyTaskService - 调度任务入口</li></ul><h2 id="_8a-5-执行流程" tabindex="-1"><a class="header-anchor" href="#_8a-5-执行流程"><span>8A.5.执行流程</span></a></h2><p>通常排定 (launch)</p><img src="https://www.plantuml.com/plantuml/svg/bLB1QiCm3BttAtGgBMJidiCeMqTXZ3BMmiwA_TgOA7AndT3-_N3Q3GPfwKwsd_IUdcGjOkAGkbOcMwUdBSVczGYpGUYT0JqyqGXSad2dffuvEoyeeFKzw8NLuAhAMz-kn5Sixzuq9OatJMPVI_zocj4bTawnP9yPRF_2L9t8sN_PDYncZMCYjoCeLmAQJeaFXto4Jk-t4xa7PQcSIGdjOPoRdTG1R3-ybnpTc1gs4uIIukKwInoRWXJ7D9zSoHvQujWWPFcIzaZdvpDORv7MFZc3CsduQgTxqW6yhnQLvBJt3IZRf1QfzlRUYW6natIfLv3rYiSTExd57n_svw1Ka16m_ax-PWjZ6n1mNjsy0J_pdooWjclb6m00" alt=""><p>强制执行 (force)</p><img src="https://www.plantuml.com/plantuml/svg/ZP11Yy8m48Nl_HLpLAXupq5aqQl8AknvDdcrGzC996cf_rvIlIohuYrva_U-oTkcp34FlQ_EejSpfsu_mPuGHx6WrOQUo8QQ42qMufQlN3-YHTsX4SMEWo4VsFsLwVTAufud570RmUuOWY_JastX1ezeA3sEYyofgqanvMNrulNy0quTOeatT46-Nx_0-ivq25aixgQv8j4BwIn-nY93ecFeG6LDwf7Ru3ubHgJ1vmUl9XSKwuR5l_F_hppnYEyvgIRhmKe7JBaGgYtK3Rs_0G00" alt="">',24)])])}const c=e(l,[["render",r]]),d=JSON.parse('{"path":"/zh/8-radiant/8a-tinytask.html","title":"8A.小任务模块","lang":"zh-CN","frontmatter":{"isOriginal":true,"icon":"clock","category":["小小","任务"],"description":"8A.小任务模块 基于Spring Schedule提供了以database为中心的任务调度 自动发现和执行 中途取消，启动，修改配置 设置任务通知 查询任务执行历史 8A.1.设计要求 TinyTask设计为强类型，静态的，因此默认限制了动态添加任务。 任务对象必须是SpringBean 使用@TinyTask.Auto注解的类可自动发现 入口方法必...","GIT_REPO_HEAD":"2025-09-01 bf16720a95aa32d38b537cc338e086dd2483e52b\\n","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"8A.小任务模块\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-09T11:57:11.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"trydofor\\",\\"url\\":\\"https://www.trydofor.com\\"}]}"],["meta",{"property":"og:url","content":"https://wings.fessional.pro/zh/8-radiant/8a-tinytask.html"}],["meta",{"property":"og:site_name","content":"WingsBoot 纹丝不忒"}],["meta",{"property":"og:title","content":"8A.小任务模块"}],["meta",{"property":"og:description","content":"8A.小任务模块 基于Spring Schedule提供了以database为中心的任务调度 自动发现和执行 中途取消，启动，修改配置 设置任务通知 查询任务执行历史 8A.1.设计要求 TinyTask设计为强类型，静态的，因此默认限制了动态添加任务。 任务对象必须是SpringBean 使用@TinyTask.Auto注解的类可自动发现 入口方法必..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-01-09T11:57:11.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-09T11:57:11.000Z"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://wings.fessional.pro/8-radiant/8a-tinytask.html"}]]},"git":{"createdTime":1672191701000,"updatedTime":1736423831000,"contributors":[{"name":"trydofor","username":"trydofor","email":"trydofor@gmail.com","commits":10,"url":"https://github.com/trydofor"}]},"readingTime":{"minutes":2.19,"words":657},"filePathRelative":"zh/8-radiant/8a-tinytask.md","autoDesc":true}');export{c as comp,d as data};
