import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,o as i,e as a}from"./app-DEdToB0k.js";const n={},o=a(`<h1 id="_4a-集成登录" tabindex="-1"><a class="header-anchor" href="#_4a-集成登录"><span>4A.集成登录</span></a></h1><p>支持多种登录，如用户名密码，Basic扩展，Oauth第三方等，可以安全且方便的控制用户来源。</p><h2 id="_4a-1-集成github" tabindex="-1"><a class="header-anchor" href="#_4a-1-集成github"><span>4A.1.集成Github</span></a></h2><p>因为Github最广泛也最简单，以其作为Oauth登录的演示。</p><p>在Github上设置并记下<code>App ID</code>，<code>Client ID</code>和<code>Client secret</code>，注意不要外泄。 设置入口为 <code>Settings</code> | <code>Developer settings</code> | <code>GitHub Apps</code></p><ul><li>启动 TestWarlockBondApplication</li><li>访问 <a href="http://localhost:8084/auth/github/login-page.html" target="_blank" rel="noopener noreferrer">http://localhost:8084/auth/github/login-page.html</a> 重定向</li><li>访问 <a href="http://localhost:8084/auth/github/login-page.json" target="_blank" rel="noopener noreferrer">http://localhost:8084/auth/github/login-page.json</a> 看数据</li><li>授权并检查 github 的响应</li><li>定制 LoginSuccessHandler 以实现不同的响应格式</li></ul><h2 id="_4a-2-是401还是302" tabindex="-1"><a class="header-anchor" href="#_4a-2-是401还是302"><span>4A.2.是401还是302</span></a></h2><p>当发生禁止访问<code>UNAUTHORIZED</code>时，spring会抛出AccessDeniedException， 再由ExceptionTranslationFilter选择合适的AuthenticationEntryPoint。</p><p>wings中，默认存在2个AuthenticationEntryPoint，</p><ul><li>LoginUrlAuthenticationEntryPoint - 用户侧的通常登录</li><li>BasicAuthenticationEntryPoint - 监控侧的basic验证</li></ul><p>LoginUrl可以通过设置login-forward，选择以何种形式提供给用户端登录。</p><p>在EntryPoint的选择上，可以设置<code>http header</code>来满足特定的匹配规则。 以下设置可跳过basic验证规则，详见 HttpBasicConfigurer.registerDefaults</p><ul><li>不含<code>X-Requested-With: XMLHttpRequest</code> header</li><li><code>Accept</code>中包括以下任意值 <ul><li>application/xhtml+xml</li><li>image/*</li><li>text/html</li><li>text/plain</li></ul></li></ul><h2 id="_4a-3-openapi3特点" tabindex="-1"><a class="header-anchor" href="#_4a-3-openapi3特点"><span>4A.3.OpenAPI3特点</span></a></h2><p>在OpenAPI3的规范中 不允许修改<code>Accept</code>，<code>Content-Type</code>和<code>Authorization</code></p><p><a href="https://swagger.io/docs/specification/describing-parameters/#header-parameters" target="_blank" rel="noopener noreferrer">https://swagger.io/docs/specification/describing-parameters/#header-parameters</a></p><blockquote><p>Note: Header parameters named Accept, Content-Type and Authorization are not allowed. To describe these headers, use the corresponding OpenAPI keywords:</p></blockquote><p>wings默认配置swagger，提供了text和json类型，分别对应LoginUrl和Basic的EntryPoint。</p><p>swagger在302时会自动导向目标页面，最终以200显示。此过程可以debug或curl看到。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -vX</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;POST&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  &#39;http://localhost:8084/user/authed-user.json&#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  -H</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;accept: text/html&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,20),s=[o];function r(l,h){return i(),t("div",null,s)}const d=e(n,[["render",r],["__file","4a-authn.html.vue"]]),u=JSON.parse('{"path":"/zh/4-warlock/4a-authn.html","title":"4A.集成登录","lang":"zh-CN","frontmatter":{"isOriginal":true,"icon":"key","category":["术士","验证"],"description":"4A.集成登录 支持多种登录，如用户名密码，Basic扩展，Oauth第三方等，可以安全且方便的控制用户来源。 4A.1.集成Github 因为Github最广泛也最简单，以其作为Oauth登录的演示。 在Github上设置并记下App ID，Client ID和Client secret，注意不要外泄。 设置入口为 Settings | Develo...","GIT_REPO_HEAD":"2025-01-17 e638e7035dc7958e3f145793e37c871eb02f12d5","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://wings.fessional.pro/4-warlock/4a-authn.html"}],["meta",{"property":"og:url","content":"https://wings.fessional.pro/zh/4-warlock/4a-authn.html"}],["meta",{"property":"og:site_name","content":"WingsBoot 纹丝不忒"}],["meta",{"property":"og:title","content":"4A.集成登录"}],["meta",{"property":"og:description","content":"4A.集成登录 支持多种登录，如用户名密码，Basic扩展，Oauth第三方等，可以安全且方便的控制用户来源。 4A.1.集成Github 因为Github最广泛也最简单，以其作为Oauth登录的演示。 在Github上设置并记下App ID，Client ID和Client secret，注意不要外泄。 设置入口为 Settings | Develo..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-12T00:21:52.000Z"}],["meta",{"property":"article:author","content":"trydofor"}],["meta",{"property":"article:modified_time","content":"2024-06-12T00:21:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"4A.集成登录\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-12T00:21:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"trydofor\\",\\"url\\":\\"https://www.trydofor.com\\"}]}"]]},"headers":[{"level":2,"title":"4A.1.集成Github","slug":"_4a-1-集成github","link":"#_4a-1-集成github","children":[]},{"level":2,"title":"4A.2.是401还是302","slug":"_4a-2-是401还是302","link":"#_4a-2-是401还是302","children":[]},{"level":2,"title":"4A.3.OpenAPI3特点","slug":"_4a-3-openapi3特点","link":"#_4a-3-openapi3特点","children":[]}],"git":{"createdTime":1656137116000,"updatedTime":1718151712000,"contributors":[{"name":"trydofor","email":"trydofor@gmail.com","commits":3}]},"readingTime":{"minutes":1.3,"words":391},"filePathRelative":"zh/4-warlock/4a-authn.md","localizedDate":"2022年6月25日","autoDesc":true}');export{d as comp,u as data};
