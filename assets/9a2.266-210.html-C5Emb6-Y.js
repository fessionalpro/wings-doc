import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as n,c as l,b as i,d as s,f as t,w as h,e as p,o as k}from"./app-DEdToB0k.js";const r={},d=i("h1",{id:"_9a2-upgrade-2-6-6-210",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_9a2-upgrade-2-6-6-210"},[i("span",null,"9A2.Upgrade 2.6.6.210")])],-1),o=i("p",null,"Upgraded build 201 to 210 with the following major incompatibility,",-1),g=i("li",null,"java 11 instead of 8, compilation and startup parameters changed",-1),c=i("li",null,"boot 2.6 instead of 2.4, webmvc, path matching changed",-1),A=i("li",null,"shardingsphere 5.1 instead of 4.1, better structure",-1),y=i("li",null,[s("flywave "),i("code",null,"__"),s(" instead of "),i("code",null,"$"),s(" to be compatible with some Cloud DB")],-1),m=i("li",null,"swagger springdoc instead of springfox to be compatible with boot2.6",-1),u=i("li",null,"fastjson2 instead of fastjson",-1),B=p(`<h2 id="_9a2-1-modify-pom-xml" tabindex="-1"><a class="header-anchor" href="#_9a2-1-modify-pom-xml"><span>9A2.1.Modify pom.xml</span></a></h2><p>Starting with 210, all artifactId are merged into <code>pro.fessional.wings</code> group. Here is how to modify parent and common dependencies.</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">project</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- change [wings-project] to [wings] --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    &lt;!-- &lt;groupId&gt;pro.fessional&lt;/groupId&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    &lt;!-- &lt;artifactId&gt;wings-project&lt;/artifactId&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;pro.fessional&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;wings&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;2.6.6.210-SNAPSHOT&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- change [wings-] from artifactId to groupId [.wings] --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  &lt;!-- &lt;groupId&gt;pro.fessional&lt;/groupId&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">  &lt;!-- &lt;artifactId&gt;wings-silencer&lt;/artifactId&gt; --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;pro.fessional.wings&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;silencer&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;\${wings.version}&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">project</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-2-upgrade-to-java11" tabindex="-1"><a class="header-anchor" href="#_9a2-2-upgrade-to-java11"><span>9A2.2.Upgrade to java11</span></a></h2><p>The current java11 used is <a href="https://jdk.java.net/archive/" target="_blank" rel="noopener noreferrer">openjdk build 11.0.2+9</a>. It is recommended to manage the java8 and java11 environment with <a href="https://asdf-vm.com" target="_blank" rel="noopener noreferrer">asdf</a> and set the <code>JDK8_HOME</code> and <code>JDK11_HOME</code> variables in the shell.</p><p>When IDEA or maven starts java program and TestCast, you need to add add-opens or add-exports parameters accordingly</p><ul><li>maven-compiler-plugin - add-exports to compile</li><li>maven-surefire-plugin - add-opens to run</li><li>IDEA run TestCase - get surefire configuration automatically</li><li>IDEA run Java and Boot - manually set the startup parameter template</li></ul><p>Where startup parameters are <code>\${wings.java-opens}</code> content, global variables like JAVA_TOOL_OPTIONS are not recommended. You need to set <code>Application</code> and <code>Spring Boot</code> in the <code>Run/Debug Configuration Templates</code> in IDEA.</p><p>References</p><ul><li><a href="https://stackoverflow.com/questions/44056405" target="_blank" rel="noopener noreferrer">What&#39;s the difference between --add-exports and --add-opens ...</a></li><li><a href="https://stackoverflow.com/questions/70196098" target="_blank" rel="noopener noreferrer">How can I specify --add-opens from a project level ...</a></li></ul><h2 id="_9a2-3-trace-table-naming" tabindex="-1"><a class="header-anchor" href="#_9a2-3-trace-table-naming"><span>9A2.3.Trace Table Naming</span></a></h2><p>Mainly log table, changed from dollar to double underscore style, trigger suffix to prefix.</p><ul><li>log table changed from <code>table$log</code> to <code>table__</code></li><li>trigger from <code>table$ai</code> to <code>ai__table</code></li></ul><p>The operation steps are as follows.</p><ul><li>Execute JournalManager.manageTriggers(table, true) to delete the old trigger</li><li>execute JournalManager.checkAndInitDdl(table, cid) to replace the old config with the new one</li><li>Rename journal table manually</li><li>Execute JournalManager.publishInsert/Update/Delete(table, true, cid) to generate a new trigger</li></ul><p>If the data is mysql8 and meets to the wings specification, you can use the following sql test.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  TABLE_NAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> TRACE_TBL,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  REPLACE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(TABLE_NAME,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;$log&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> PLAIN_TBL,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  CONCAT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ALTER TABLE &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,table_name,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; RENAME TO &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">REPLACE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(table_name, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;$log&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;;;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> RENAME_DDL</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> INFORMATION_SCHEMA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">TABLES</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_schema </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> DATABASE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  AND</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> table_name REGEXP </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\\\\$log&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  TRIGGER_NAME </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> OLD_NAME,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  REGEXP_REPLACE(TRIGGER_NAME,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;^(.+)\\\\$(.+)$&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;$2__$1&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> NEW_NAME,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  CONCAT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;DROP TRIGGER IF EXISTS &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,TRIGGER_NAME,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;;;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> DROP_DDL,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">  REPLACE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">CONCAT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;CREATE TRIGGER \`&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, REGEXP_REPLACE(TRIGGER_NAME,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;^(.+)\\\\$(.+)$&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;$2__$1&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\` &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ACTION_TIMING, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, EVENT_MANIPULATION, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; ON \`&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, EVENT_OBJECT_TABLE, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\` FOR EACH ROW &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ACTION_STATEMENT, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;;;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;$log&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> CREATE_DDL</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  INFORMATION_SCHEMA</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">TRIGGERS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  EVENT_OBJECT_SCHEMA </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> database</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">--</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">DELIMITER ;;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">-- Copy the above DROP_DDL, RENAME_DDL, CREATE_DDL and execute them in order.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-4-remove-lombok-s-var" tabindex="-1"><a class="header-anchor" href="#_9a2-4-remove-lombok-s-var"><span>9A2.4.Remove lombok&#39;s var</span></a></h2><p>import lombok.var;</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;*.java&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> read</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/import lombok.var;//g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-5-swagger3-0-annotation" tabindex="-1"><a class="header-anchor" href="#_9a2-5-swagger3-0-annotation"><span>9A2.5.Swagger3.0 Annotation</span></a></h2><p>springdoc fully uses OpenApi/Swagger3.0, so springfox&#39;s Swagger2.0 annotations need to be replaced. See <a href="https://springdoc.org/#migrating-from-springfox" target="_blank" rel="noopener noreferrer">https://springdoc.org/#migrating-from-springfox</a> for details</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># check swagger2 annotation</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;*.java&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> read</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;import io.swagger.annotations&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/tmp/swagger.log</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sort</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/swagger.log</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">uniq</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/swagger.log</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Replace common tags and modify compilation errors caused by formatting deviations</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> f</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;*.java&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> read</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">do</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/import io.swagger.annotations.ApiModel;/import io.swagger.v3.oas.annotations.media.Schema;/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/import io.swagger.annotations.ApiModelProperty;/import io.swagger.v3.oas.annotations.media.Schema;/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/import io.swagger.annotations.Api;/import io.swagger.v3.oas.annotations.tags.Tag;/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/import io.swagger.annotations.ApiOperation;/import io.swagger.v3.oas.annotations.Operation;/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/@ApiModel\\((.*)\\)/@Schema(description = \\1)/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/@ApiModelProperty\\((.*)\\)/@Schema(description = \\1)/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/@Api\\((.*)\\)/@Tag(name = \\1)/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -E</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/@ApiOperation\\((.*)\\)/@Operation(summary = \\1)/g&#39;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $fl</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-6-upgrade-to-mysql8" tabindex="-1"><a class="header-anchor" href="#_9a2-6-upgrade-to-mysql8"><span>9A2.6.Upgrade to Mysql8</span></a></h2><ul><li><a href="https://dev.mysql.com/doc/refman/8.0/en/upgrade-binary-package.html" target="_blank" rel="noopener noreferrer">Logical Upgrade</a></li><li><a href="https://dev.mysql.com/blog-archive/inplace-upgrade-from-mysql-5-7-to-mysql-8-0" target="_blank" rel="noopener noreferrer">In-Place Upgrade</a></li><li><a href="https://dev.mysql.com/doc/mysql-shell/8.0/en/mysql-shell-utilities-upgrade.html" target="_blank" rel="noopener noreferrer">mysql shell</a></li></ul><p>Wings project use jooq, avoid complex sql, only sql basic features, generally no compatibility. Can use mysql shell to check,</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Option 1, need to install mysql shell</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlsh</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> util</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checkForServerUpgrade</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root@wings-sql-dev5:3306</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --target-version=8.0.26</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --output-format=JSON</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Option 2, use mysql-client 8.0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlcheck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --protocol=tcp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kite-sql-dev5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --all-databases</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --check-upgrade</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>In-Place upgrade, that is, use the original data directory of 5.7, start mysql8 directly, and adjust its data structure automatically. Simple database (single machine, single container) is recommended, such as using docker to start mysql8.0, and check the following 2 items to upgrade automatically.</p><ul><li>Its data points to mysql5.7&#39;s data.</li><li>Configure upgrade=FORCE in mysqld</li></ul><p>Logical upgrade, meaning dump first and then restore, is recommended for complex databases (cloud, master-slave, cluster). When restoring directly from 5.7 FullDump to 8.0, you need to set the permission of <code>upgrade=FORCE</code> to full last upgrade. Otherwise, the user will be able to log in, but Access denied, so that the support users and features are not good.</p><p>Therefore, it is recommended to dump business users and datas separately on machines with mysql8 client, and then restore.</p><ul><li>dump mysql5.7 business user, business data</li><li>restore mysql 8.0 user first then data</li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Generate config file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kite-sql.cnf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&lt; </span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[client]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">protocol=tcp</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">port=3306</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">user=trydofor</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">password=moilioncircle</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># Use mysqlpump to support more options, all using mysql8&#39;s client</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlpump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --defaults-extra-file=kite-sql.cnf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kite-sql-dev5</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">--all-databases </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">--exclude-databases=information_schema,mysql,performance_schema,sys</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">--set-gtid-purged=OFF &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql-5.7-data.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysqlpump</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --defaults-extra-file=kite-sql.cnf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kite-sql-dev5</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">--users </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">--exclude-users=root,%backup</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">--exclude-databases=% </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">--set-gtid-purged=OFF</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql-5.7-user.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;flush privileges;&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt;&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">mysql-5.7-user.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># If the dump is not ignoring innodb_*_status, you need to use --force to skip the error</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql-5.7-user.sql</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mysql-5.7-data.sql</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> \\</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mysql</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --defaults-extra-file=kite-sql.cnf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kite-sql-dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-7-damaging-impact" tabindex="-1"><a class="header-anchor" href="#_9a2-7-damaging-impact"><span>9A2.7.Damaging Impact</span></a></h2><ul><li>wings-project is no longer dependent on devtools, and projects using it as a parent must add the dependency.</li><li>Changed the url permission config of warlock security from list to map, clarifying the override relationship from loose to strict.</li><li>Mirana rewrite DateLocaling method name, if compile error, you can rely on the parameter signature, bulk replacement method name.</li><li>Warlock1SchemaManager rename methods</li><li>Rename @JsonI18nString to @AutoI18nString</li></ul><h2 id="_9a2-8-jooqdao-incompatible" tabindex="-1"><a class="header-anchor" href="#_9a2-8-jooqdao-incompatible"><span>9A2.8.JooqDao Incompatible</span></a></h2><p>The previous static reference is no longer recommended.</p><ul><li>val t = dao.getTable()</li><li>val a = dao.getAlias()</li></ul><p>It is recommended to define local variables with dao.getTable and getAlias instead of static global tables. The previous fetch(Condition) signature can be changed to the following form</p><ul><li>fetch(Table, Condition)</li><li>fetch(t -&gt; Fn.of(t.Id.eq(1L)))</li></ul><h2 id="_9a2-9-external-api-compatibility" tabindex="-1"><a class="header-anchor" href="#_9a2-9-external-api-compatibility"><span>9A2.9.External Api Compatibility</span></a></h2><ul><li><p>mysql8 does not have password function, use the following combination to replace it. SELECT CONCAT(&#39;*&#39;, UPPER(SHA1(UNHEX(SHA1(&#39;trydofor&#39;))))), password(&#39;trydofor&#39;);</p></li><li><p>Adjustment of DateTimeFormatter in java11, such as Offset X&#39;s original <code>XXX</code> cannot represent <code>XXXX</code> and <code>XXXXX</code>, and so on.</p></li><li><p>fastjson2, you should simply replace <code>com.alibaba.fastjson.</code> with <code>com.alibaba.fastjson2.</code>. If the dependency on fastjson is too heavy and complex, please check the quality of the project and make sure the usage is safe.</p></li></ul><h2 id="_9a2-a-anthn-typo" tabindex="-1"><a class="header-anchor" href="#_9a2-a-anthn-typo"><span>9A2.A.Anthn Typo</span></a></h2><p>Execute <code>2021-09-18v01</code> via Flywave to fix <code>win_user_anthn</code> typo error</p><h3 id="a1-execute-sql-script" tabindex="-1"><a class="header-anchor" href="#a1-execute-sql-script"><span>a1.Execute Sql Script</span></a></h3><p>If there is no shard table and no trace table, you can execute the upgrade sql manually. Otherwise, it is recommended to use flywave to execute it to avoid missing.</p><ul><li>rename win_user_anthn</li><li>update sys_light_sequence</li><li>update shard table_#</li><li>update trace table$log</li><li>update triggers</li></ul><h3 id="a2-replace-java-file" tabindex="-1"><a class="header-anchor" href="#a2-replace-java-file"><span>a2.Replace Java File</span></a></h3><p>Whole project java file, replace the following strings,</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/user_anthn/user_authn/g&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sed</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;s/UserAnthn/UserAuthn/g&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-b-split-warlockbond" tabindex="-1"><a class="header-anchor" href="#_9a2-b-split-warlockbond"><span>9A2.B.Split WarlockBond</span></a></h2><p>The default database implementation of user privileges, split into the warlock-bond project.</p><ul><li>if not needed, dependency warlock</li><li>otherwise, dependency warlock-bond</li></ul><p>Also add <code>2020-10-23v01</code> to remove flywave-fit warnings.</p><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" data-title="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INSERT IGNORE INTO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> \`sys_schema_version\`</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`revision\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`commit_id\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`apply_dt\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`comments\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`upto_sql\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">\`undo_sql\`</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VALUES</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2020102302</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">NOW</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-c-split-codegen" tabindex="-1"><a class="header-anchor" href="#_9a2-c-split-codegen"><span>9A2.C.Split CodeGen</span></a></h2><p>code generation tools, split into separate projects, faceless-codegen and warlock-codegen, respectively. In practice, the direct dependency on warlock-codegen can be used, the sample maven configuration is as follows</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;pro.fessional.wings&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;warlock-codegen&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;test&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">scope</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a2-d-i18n-change" tabindex="-1"><a class="header-anchor" href="#_9a2-d-i18n-change"><span>9A2.D.I18n Change</span></a></h2><p>The semantics of <code>ukey</code> in <code>sys_standard_i18n</code> is to constrain unique data or enum class location members</p><ul><li><code>id</code> type - <code>id.</code> + id</li><li><code>code</code> type - type + <code>.</code> + code</li><li>java enum, consists of package, class, member name</li></ul><p>changes include, data records and generated code of I18n,</p><ul><li>replace the data, such as 2019-05-21v01-enum-i18n.sql</li><li>regenerate the template code, such as StandardLanguage</li></ul><h2 id="_9a2-e-properties-change" tabindex="-1"><a class="header-anchor" href="#_9a2-e-properties-change"><span>9A2.E.Properties Change</span></a></h2><h3 id="e1-wings-monitor-79-properties" tabindex="-1"><a class="header-anchor" href="#e1-wings-monitor-79-properties"><span>e1.wings-monitor-79.properties</span></a></h3><ul><li>change <code>report-keyword</code> to <code>notice-keyword</code></li></ul>`,66);function v(F,b){const a=n("RouteLink");return k(),l("div",null,[d,o,i("ul",null,[g,c,A,y,m,u,i("li",null,[s("check "),t(a,{to:"/9-example/9a.wings-change/9a0.notable.html"},{default:h(()=>[s("wings notable changelog")]),_:1})])]),B])}const E=e(r,[["render",v],["__file","9a2.266-210.html.vue"]]),_=JSON.parse(`{"path":"/9-example/9a.wings-change/9a2.266-210.html","title":"9A2.Upgrade 2.6.6.210","lang":"en-US","frontmatter":{"isOriginal":true,"icon":"circle-up","category":["Practice","Upgrade"],"description":"9A2.Upgrade 2.6.6.210 Upgraded build 201 to 210 with the following major incompatibility, java 11 instead of 8, compilation and startup parameters changed boot 2.6 instead of 2....","GIT_REPO_HEAD":"2025-01-17 e638e7035dc7958e3f145793e37c871eb02f12d5","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://wings.fessional.pro/zh/9-example/9a.wings-change/9a2.266-210.html"}],["meta",{"property":"og:url","content":"https://wings.fessional.pro/9-example/9a.wings-change/9a2.266-210.html"}],["meta",{"property":"og:site_name","content":"WingsBoot Win Sprint"}],["meta",{"property":"og:title","content":"9A2.Upgrade 2.6.6.210"}],["meta",{"property":"og:description","content":"9A2.Upgrade 2.6.6.210 Upgraded build 201 to 210 with the following major incompatibility, java 11 instead of 8, compilation and startup parameters changed boot 2.6 instead of 2...."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-06-12T00:21:52.000Z"}],["meta",{"property":"article:author","content":"trydofor"}],["meta",{"property":"article:modified_time","content":"2024-06-12T00:21:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"9A2.Upgrade 2.6.6.210\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-06-12T00:21:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"trydofor\\",\\"url\\":\\"https://www.trydofor.com\\"}]}"]]},"headers":[{"level":2,"title":"9A2.1.Modify pom.xml","slug":"_9a2-1-modify-pom-xml","link":"#_9a2-1-modify-pom-xml","children":[]},{"level":2,"title":"9A2.2.Upgrade to java11","slug":"_9a2-2-upgrade-to-java11","link":"#_9a2-2-upgrade-to-java11","children":[]},{"level":2,"title":"9A2.3.Trace Table Naming","slug":"_9a2-3-trace-table-naming","link":"#_9a2-3-trace-table-naming","children":[]},{"level":2,"title":"9A2.4.Remove lombok's var","slug":"_9a2-4-remove-lombok-s-var","link":"#_9a2-4-remove-lombok-s-var","children":[]},{"level":2,"title":"9A2.5.Swagger3.0 Annotation","slug":"_9a2-5-swagger3-0-annotation","link":"#_9a2-5-swagger3-0-annotation","children":[]},{"level":2,"title":"9A2.6.Upgrade to Mysql8","slug":"_9a2-6-upgrade-to-mysql8","link":"#_9a2-6-upgrade-to-mysql8","children":[]},{"level":2,"title":"9A2.7.Damaging Impact","slug":"_9a2-7-damaging-impact","link":"#_9a2-7-damaging-impact","children":[]},{"level":2,"title":"9A2.8.JooqDao Incompatible","slug":"_9a2-8-jooqdao-incompatible","link":"#_9a2-8-jooqdao-incompatible","children":[]},{"level":2,"title":"9A2.9.External Api Compatibility","slug":"_9a2-9-external-api-compatibility","link":"#_9a2-9-external-api-compatibility","children":[]},{"level":2,"title":"9A2.A.Anthn Typo","slug":"_9a2-a-anthn-typo","link":"#_9a2-a-anthn-typo","children":[{"level":3,"title":"a1.Execute Sql Script","slug":"a1-execute-sql-script","link":"#a1-execute-sql-script","children":[]},{"level":3,"title":"a2.Replace Java File","slug":"a2-replace-java-file","link":"#a2-replace-java-file","children":[]}]},{"level":2,"title":"9A2.B.Split WarlockBond","slug":"_9a2-b-split-warlockbond","link":"#_9a2-b-split-warlockbond","children":[]},{"level":2,"title":"9A2.C.Split CodeGen","slug":"_9a2-c-split-codegen","link":"#_9a2-c-split-codegen","children":[]},{"level":2,"title":"9A2.D.I18n Change","slug":"_9a2-d-i18n-change","link":"#_9a2-d-i18n-change","children":[]},{"level":2,"title":"9A2.E.Properties Change","slug":"_9a2-e-properties-change","link":"#_9a2-e-properties-change","children":[{"level":3,"title":"e1.wings-monitor-79.properties","slug":"e1-wings-monitor-79-properties","link":"#e1-wings-monitor-79-properties","children":[]}]}],"git":{"createdTime":1656137116000,"updatedTime":1718151712000,"contributors":[{"name":"trydofor","email":"trydofor@gmail.com","commits":9}]},"readingTime":{"minutes":4.85,"words":1456},"filePathRelative":"9-example/9a.wings-change/9a2.266-210.md","localizedDate":"June 25, 2022","autoDesc":true}`);export{E as comp,_ as data};
