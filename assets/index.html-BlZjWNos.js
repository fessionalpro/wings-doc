import{_ as i}from"./warlock_icon-DsMZnnfh.js";import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,b as p,d as r,f as o,e as t,g as a,r as d,o as u}from"./app-CCOA2OJI.js";const c={};function h(m,e){const l=d("RouteLink");return u(),s("div",null,[e[14]||(e[14]=p('<h1 id="_4-术士大叔" tabindex="-1"><a class="header-anchor" href="#_4-术士大叔"><span>4.术士大叔</span></a></h1><p><img src="'+i+'" alt="warlock"></p><blockquote><p>无视魔免的地狱火加上致命链接，可以瞬间改变局势。</p></blockquote><p>基于Faceless和Slardar，提供了基本用户，鉴权授权，访问控制，数据隔离等功能。</p><h2 id="_4-1-模块划分" tabindex="-1"><a class="header-anchor" href="#_4-1-模块划分"><span>4.1.模块划分</span></a></h2><ul><li>warlock - 集成jooq和slardar</li><li>warlock-shadow - 集成slardar-sprint</li><li>warlock-bond - 集成登录授权的实现</li><li>warlock-codegen - 工程代码生成</li><li>warlock-test - 测试包，安全的登录</li></ul><h2 id="_4-2-访问控制" tabindex="-1"><a class="header-anchor" href="#_4-2-访问控制"><span>4.2.访问控制</span></a></h2><p>Warlock的访问控制，聚焦在以下几个场景和技术层面，</p><ul><li>Filter(Url) - 粗粒度控制场景，如角色，职能</li><li>Method(Aop) - 细粒度控制功能，如读取，写入，删除</li><li>Data - 数据隔离，如对象控制，ACL</li></ul><p>通过Url前缀特征，比较集中和简单，推荐使用。而Aop比较分散，粒度更细致。</p><p>在做Url的Matcher时，尽量避免规则交叉，特殊配置在前，AnyRequest在最后做默认配置， 当规则有交叉时，按FIFO匹配，spring中的调用关系如下，其底层数据结构是LinkedHashMap。</p><ul><li>FilterSecurityInterceptor.beforeInvocation</li><li>DefaultFilterInvocationSecurityMetadataSource.getAttributes</li></ul><p>wings配置顺序由宽松到严格(PermitAll &gt; Authenticated &gt; Authority)，最后AnyRequest收尾。 在Authority配置时，会按URL分组合并权限，以URL的ascii倒序排序，即英数先于<code>*</code>，宽松规则在后。</p><h2 id="_4-3-部分使用" tabindex="-1"><a class="header-anchor" href="#_4-3-部分使用"><span>4.3.部分使用</span></a></h2><p>Warlock提供了一套预定义的auth-perm-role体系，包括表结构，数据关系等。</p><p>默认实现的authn-authz和perm-role体系，依赖于全局UserId，具有一定限制。 任何系统中，登录及权限都有重要的安防和性能意义，通常有较高的集成度和复杂度。 所以，在部分使用此功能时，需要逐一排查配置项及注入的Bean。</p><p>默认实现中，读取及累积计数时，若数据库不存在对应表，则返回empty或忽略。</p><h2 id="_4-4-全部使用" tabindex="-1"><a class="header-anchor" href="#_4-4-全部使用"><span>4.4.全部使用</span></a></h2><p>WebSecurity在SpringBoot(3.0以前)需要继承Adapter实现配置，其约束很多， 因此在使用wings提供的自动配置功能时，需要注意以下特殊Bean的声明。</p><ul><li>WebSecurity - expose WebSecurityCustomizer Bean</li><li>HttpWebSecurity - expose HttpSecurityCustomizer Bean</li></ul><p>自定义WebSecurityConfigurerAdapter，需要注意Bean的生命周期和顺序关系。</p><blockquote><p>Is there an unresolvable circular reference? Error creating bean with name &#39;springSecurityFilterChain&#39;: Requested bean is currently in creation.</p></blockquote><p>以上错误，会发生在注入WebSecurityConfiguration的<code>@Bean</code>时。 总之，WebSecurity有特殊Bean，Configurer的链式调用也有顺序要求。</p><h2 id="_4-5-更多章节" tabindex="-1"><a class="header-anchor" href="#_4-5-更多章节"><span>4.5.更多章节</span></a></h2>',24)),r("ul",null,[r("li",null,[o(l,{to:"/zh/4-warlock/4a-authn.html"},{default:a(()=>e[0]||(e[0]=[t("集成登录")])),_:1}),e[1]||(e[1]=t(" - 多种登录方式，身份验证和令牌策略"))]),r("li",null,[o(l,{to:"/zh/4-warlock/4b-authz.html"},{default:a(()=>e[2]||(e[2]=[t("组合授权")])),_:1}),e[3]||(e[3]=t(" - 权限(Perm)和角色(Role)的令牌体系"))]),r("li",null,[o(l,{to:"/zh/4-warlock/4c-security.html"},{default:a(()=>e[4]||(e[4]=[t("安全定制")])),_:1}),e[5]||(e[5]=t(" - 定制登录，验证，授权"))]),r("li",null,[o(l,{to:"/zh/4-warlock/4e-tweak.html"},{default:a(()=>e[6]||(e[6]=[t("动态调节")])),_:1}),e[7]||(e[7]=t(" - 全局及线程级调试时间，日志和异常"))]),r("li",null,[o(l,{to:"/zh/4-warlock/4f-api-oauth.html"},{default:a(()=>e[8]||(e[8]=[t("对外Api")])),_:1}),e[9]||(e[9]=t(" - 限定功能的对外Api"))]),r("li",null,[o(l,{to:"/zh/4-warlock/4g-watching.html"},{default:a(()=>e[10]||(e[10]=[t("调用计时")])),_:1}),e[11]||(e[11]=t(" - 对慢请求做计时及日志"))]),r("li",null,[o(l,{to:"/zh/4-warlock/4h-uni-auth.html"},{default:a(()=>e[12]||(e[12]=[t("联合登录")])),_:1}),e[13]||(e[13]=t(" - 在wings应用能实现联合登录"))])])])}const w=n(c,[["render",h],["__file","index.html.vue"]]),y=JSON.parse('{"path":"/zh/4-warlock/","title":"4.术士大叔","lang":"zh-CN","frontmatter":{"isOriginal":true,"icon":"circle-user","category":["术士","首页"],"description":"4.术士大叔 warlock 无视魔免的地狱火加上致命链接，可以瞬间改变局势。 基于Faceless和Slardar，提供了基本用户，鉴权授权，访问控制，数据隔离等功能。 4.1.模块划分 warlock - 集成jooq和slardar warlock-shadow - 集成slardar-sprint warlock-bond - 集成登录授权的实...","GIT_REPO_HEAD":"2025-02-06 a8fb043a36c51604d1078076241b71fc4a4529a1","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://wings.fessional.pro/4-warlock/"}],["meta",{"property":"og:url","content":"https://wings.fessional.pro/zh/4-warlock/"}],["meta",{"property":"og:site_name","content":"WingsBoot 纹丝不忒"}],["meta",{"property":"og:title","content":"4.术士大叔"}],["meta",{"property":"og:description","content":"4.术士大叔 warlock 无视魔免的地狱火加上致命链接，可以瞬间改变局势。 基于Faceless和Slardar，提供了基本用户，鉴权授权，访问控制，数据隔离等功能。 4.1.模块划分 warlock - 集成jooq和slardar warlock-shadow - 集成slardar-sprint warlock-bond - 集成登录授权的实..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://wings.fessional.pro/warlock_icon.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-06-12T00:21:52.000Z"}],["meta",{"property":"article:modified_time","content":"2024-06-12T00:21:52.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"4.术士大叔\\",\\"image\\":[\\"https://wings.fessional.pro/warlock_icon.png\\"],\\"dateModified\\":\\"2024-06-12T00:21:52.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"trydofor\\",\\"url\\":\\"https://www.trydofor.com\\"}]}"]]},"headers":[{"level":2,"title":"4.1.模块划分","slug":"_4-1-模块划分","link":"#_4-1-模块划分","children":[]},{"level":2,"title":"4.2.访问控制","slug":"_4-2-访问控制","link":"#_4-2-访问控制","children":[]},{"level":2,"title":"4.3.部分使用","slug":"_4-3-部分使用","link":"#_4-3-部分使用","children":[]},{"level":2,"title":"4.4.全部使用","slug":"_4-4-全部使用","link":"#_4-4-全部使用","children":[]},{"level":2,"title":"4.5.更多章节","slug":"_4-5-更多章节","link":"#_4-5-更多章节","children":[]}],"git":{"createdTime":1680228107000,"updatedTime":1718151712000,"contributors":[{"name":"trydofor","username":"trydofor","email":"trydofor@gmail.com","commits":5,"url":"https://github.com/trydofor"}]},"readingTime":{"minutes":2.4,"words":721},"filePathRelative":"zh/4-warlock/README.md","localizedDate":"2023年3月31日","autoDesc":true}');export{w as comp,y as data};
