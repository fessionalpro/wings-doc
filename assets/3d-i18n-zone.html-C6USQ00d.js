import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as n,c as t,b as l,d as i,f as h,w as r,e as s,o as d}from"./app-DEdToB0k.js";const o={},p=s(`<h1 id="_3d-multiple-time-and-lang" tabindex="-1"><a class="header-anchor" href="#_3d-multiple-time-and-lang"><span>3D.Multiple Time and Lang</span></a></h1><p>In Silencer configuration, all I18n messages located in <code>wings-i18n/</code> are automatically loaded.</p><h2 id="_3d-1-loading-order" tabindex="-1"><a class="header-anchor" href="#_3d-1-loading-order"><span>3D.1.Loading Order</span></a></h2><p>With <code>LocaleResolver</code>, the current locale are set in the following order of priority.</p><ol><li>the <code>WINGS.I18N_CONTEXT</code> attr in the request</li><li>query string <code>locale</code>, <code>zoneid</code></li><li>http header <code>Accept-Language</code>, <code>Zone-Id</code></li><li>cookie <code>Wings-Locale</code>, <code>Wings-Zoneid</code></li><li>login user&#39;s SecurityContext to get Wings settings</li><li>system default value</li></ol><p>Note: <code>zoneid</code> is a word in DB and config, while <code>ZoneId</code> is a class (I capitalized) in java. So, when selecting from Db and getting it by reflection, it is easy to miss the assignment of ZoneId due to case sensitive.</p><p>The <code>LocaleResolver</code> acts in the <code>doService</code>, after the <code>doFilter</code>, so there is no Context in the <code>Filter</code>.</p><h2 id="_3d-2-locale-resolver" tabindex="-1"><a class="header-anchor" href="#_3d-2-locale-resolver"><span>3D.2.Locale Resolver</span></a></h2><p><code>WingsLocaleResolver</code> is a servlet implementation and does not support webflux.</p><ul><li>After user login, Locale and ZoneId is automatically generated in the Context</li><li><code>SecurityContextUtil</code> gets the Context in the Mvc layer, implemented by Filter</li><li><code>WingsTerminalContext</code> is used in the Service layer, implemented by TerminalInterceptor</li></ul><p>For multiple timezones, the Enum is used to automatically generate the standard timezones to parse and use. In terms of encoding naming, the type relationships and naming conventions are as follows.</p><ul><li>language - corresponds to StandardLanguageEnum</li><li>timezone - corresponds to StandardTimezoneEnum</li><li>locale - corresponds to java.util.</li><li>zoneid - corresponds to java.time.</li></ul><p>In js environment, use <code>Intl.DateTimeFormat().resolvedOptions().timeZone</code> to get the timezone. If the client cannot get the zoneid, it can get the zone info from server, use its offset, country to determine by itself.</p><h2 id="_3d-3-i18n-placeholder" tabindex="-1"><a class="header-anchor" href="#_3d-3-i18n-placeholder"><span>3D.3.I18n Placeholder</span></a></h2><p><code>@Valid</code> of JavaBean Validation supports the Unified Expression Language (JSR 341). Use <code>\${}</code> to access external variables and <code>{}</code> to access variables within annotation, as in the following example</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Size</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">( </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">min</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> max</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> message</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;{common.email.size}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"># </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Set</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> in the i18n message</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">common</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> The</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> author email </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;\${validatedValue}&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> must be between {min} and {max}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>And in <code>Message&#39;s ResourceBundle</code>, it use the array <code>{0}</code> format of java.text by default.</p><h2 id="_3d-4-i18n-practice" tabindex="-1"><a class="header-anchor" href="#_3d-4-i18n-practice"><span>3D.4.I18n Practice</span></a></h2><p>For I18n supported project , in addition to defining Code for static Message, the greater workload is handling dynamic business messages. The more common ones are such as input parameter checking, execution state checking, output result confirmation, etc.</p><h3 id="_4a-pre-condition-check" tabindex="-1"><a class="header-anchor" href="#_4a-pre-condition-check"><span>4a.Pre-condition check</span></a></h3><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// throw stackless CodeException</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RequestMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/test/code-exception.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> codeException</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">() {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    AssertArgs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">isTrue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">CommonErrorEnum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">AssertEmpty1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;args&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> CodeException</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> CommonErrorEnum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">AssertEmpty1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;test&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// use Validation annotation</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Data</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Ins</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">NotBlank</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;{test.name.empty}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Email</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;{test.email.invalid}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> String</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> email</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RequestMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/test/binding-error-from.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> R</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> bindingErrorFrom</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Valid</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Ins</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> ins) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> R</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ok</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(ins);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4b-r-w-group-verification" tabindex="-1"><a class="header-anchor" href="#_4b-r-w-group-verification"><span>4b.R/W Group Verification</span></a></h3><p>In Mvc practice, the recommended pattern is to use groups to distinguish between insert and update validation</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// FormData, containing all fields, more concise, but note the use of</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// Inherited pattern OutSkuUpd extends OutSkuAdd, verbose but typesafe</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Data</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> OutSkuForm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">NotNull</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">message</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;{form.validate.updateoutsku.id}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> groups</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">})</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Schema</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">description</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Spec id, required for updates&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    private</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Long</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> id</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// Controller use @Validated group</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Operation</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">summary</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;modify Spec&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">PostMapping</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;/wh/outsku/update-outsku.json&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> R</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">Object</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> updateOutSku</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">RequestBody</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Validated</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">value</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> {</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">Update</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">class</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}) </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">OutSkuForm</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> ins) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> R</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4c-execution-state-check" tabindex="-1"><a class="header-anchor" href="#_4c-execution-state-check"><span>4c.Execution State Check</span></a></h3><p>Predefined CodeEnum, associated Message resource, output I18n message via global exception handling</p><ul><li><code>AssertState</code> - like AssertArgs, throws stackless exceptions</li><li><code>MessageException</code> - throws a stackless exception with code</li><li><code>CodeException</code> - by default throws a stacked exception</li><li><code>I18nString</code> - automatically convert to String output via json</li><li><code>@JsonI18nString</code> - annotate the field for automatic json conversion</li></ul><h3 id="_4d-i18n-message-resources" tabindex="-1"><a class="header-anchor" href="#_4d-i18n-message-resources"><span>4d.I18n message resources</span></a></h3>`,28),k=s('<h2 id="_3d-5-three-kinds-of-datetime" tabindex="-1"><a class="header-anchor" href="#_3d-5-three-kinds-of-datetime"><span>3D.5.Three Kinds of DateTime</span></a></h2><p>Multiple timezones, for data readability and coding convenience, slardar use the following conventions.</p><ul><li><code>system timezone</code> (system) - application/system run, unified on Jvm and Db</li><li><code>data timezone</code> (origin) - the data or users are located</li><li><code>user timezone</code> (client) - the user wants to see when reading the data</li></ul><p>In general, these three are unified, e.g. all in Beijing time <code>GMT+8</code>. For data that is not timezone sensitive, LocalDateTime is usually a good choice, without the timezone.</p><p>In the slardar business scenarios, the system timezone is used uniformly in the business layer, using LocalDateTime. And in the Controller layer, it is responsible for the two-way conversion of system and user timezones, using ZonedDateTime.</p><ul><li>Uniformly use <code>LocalDateTime</code> for timezone insensitive or localtime only cases</li><li>Automatic conversion in Jackson and RequestParam if timezone is sensitive <ul><li>When Request, auto converts user time to the system timezone</li><li>When Response, auto converts system time to the user timezone</li></ul></li><li>The following three types of auto-conversion are available, <ul><li><code>LocalDateTime</code> disabled by default, not recommended to convert</li><li><code>ZonedDatetime</code> disabled by default, historical compatibility</li><li><code>OffsetDateTime</code> enabled by default</li></ul></li><li>Use the <code>@AutoTimeZone</code> to specify the conversion behavior of the 3 types of dates <ul><li>Use on Dto&#39;s Field to auto convert in RequestBody and ResponseBody</li><li>Work with Spring&#39;s @RequestParam for Param</li></ul></li><li>Use AutoDtoHelper to replace Dto properties outside of Spring administration, currently the following annotations are supported <ul><li>@AutoDtoAble - traverses internal properties</li><li>@AutoTimeZone - auto convert 3 types of dates</li><li>@AutoI18nString - auto convert String or I18nString</li></ul></li></ul><p>Note: due to a defect in util.Date, in wings, you have to use the <code>java.time.*</code> instead .</p><p>For example, the 3 timezones are not the same, for more testcases see <code>DateTimeConverterTest.java</code></p><p>Example A: An online classroom application, Chinese student and NewYork teacher, schedule a class time. then.</p><ul><li>Assume that the system is on UTC time, i.e. system=<code>UTC+0</code></li><li>the student and teacher client are <code>Asia/Shanghai</code> and <code>America/New_York</code> respectively</li><li>When making an appointment, you need to display the time by client separately to improve the appointment experience</li></ul><p>Example B: A cross-border e-commerce application, NewYork users, via overseas shipping warehouse, buy things in xxBao. then.</p><ul><li>Assume that xxBao is on East 8, i.e. system=<code>UTC+8</code></li><li>NY user&#39;s (client) is <code>America/New_York</code></li><li>LA shipping warehouse, i.e. (origin) is <code>America/Los_Angeles</code></li><li>Order information, which will be displayed in client time</li><li>Logistics information displayed in local time(origin) without conversion</li><li>Statistical information, usually also displayed in data/origin time</li></ul>',12);function c(g,u){const e=n("RouteLink");return d(),t("div",null,[p,l("p",null,[i("See "),h(e,{to:"/0-wings/0i-i18n-message.html"},{default:r(()=>[i("I18n Message")]),_:1})]),k])}const A=a(o,[["render",c],["__file","3d-i18n-zone.html.vue"]]),B=JSON.parse('{"path":"/3-slardar/3d-i18n-zone.html","title":"3D.Multiple Time and Lang","lang":"en-US","frontmatter":{"isOriginal":true,"icon":"language","category":["Slardar","Timezone","I18n"],"description":"3D.Multiple Time and Lang In Silencer configuration, all I18n messages located in wings-i18n/ are automatically loaded. 3D.1.Loading Order With LocaleResolver, the current local...","GIT_REPO_HEAD":"2025-01-17 e638e7035dc7958e3f145793e37c871eb02f12d5","head":[["link",{"rel":"alternate","hreflang":"zh-cn","href":"https://wings.fessional.pro/zh/3-slardar/3d-i18n-zone.html"}],["meta",{"property":"og:url","content":"https://wings.fessional.pro/3-slardar/3d-i18n-zone.html"}],["meta",{"property":"og:site_name","content":"WingsBoot Win Sprint"}],["meta",{"property":"og:title","content":"3D.Multiple Time and Lang"}],["meta",{"property":"og:description","content":"3D.Multiple Time and Lang In Silencer configuration, all I18n messages located in wings-i18n/ are automatically loaded. 3D.1.Loading Order With LocaleResolver, the current local..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-17T01:41:26.000Z"}],["meta",{"property":"article:author","content":"trydofor"}],["meta",{"property":"article:modified_time","content":"2025-01-17T01:41:26.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"3D.Multiple Time and Lang\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-17T01:41:26.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"trydofor\\",\\"url\\":\\"https://www.trydofor.com\\"}]}"]]},"headers":[{"level":2,"title":"3D.1.Loading Order","slug":"_3d-1-loading-order","link":"#_3d-1-loading-order","children":[]},{"level":2,"title":"3D.2.Locale Resolver","slug":"_3d-2-locale-resolver","link":"#_3d-2-locale-resolver","children":[]},{"level":2,"title":"3D.3.I18n Placeholder","slug":"_3d-3-i18n-placeholder","link":"#_3d-3-i18n-placeholder","children":[]},{"level":2,"title":"3D.4.I18n Practice","slug":"_3d-4-i18n-practice","link":"#_3d-4-i18n-practice","children":[{"level":3,"title":"4a.Pre-condition check","slug":"_4a-pre-condition-check","link":"#_4a-pre-condition-check","children":[]},{"level":3,"title":"4b.R/W Group Verification","slug":"_4b-r-w-group-verification","link":"#_4b-r-w-group-verification","children":[]},{"level":3,"title":"4c.Execution State Check","slug":"_4c-execution-state-check","link":"#_4c-execution-state-check","children":[]},{"level":3,"title":"4d.I18n message resources","slug":"_4d-i18n-message-resources","link":"#_4d-i18n-message-resources","children":[]}]},{"level":2,"title":"3D.5.Three Kinds of DateTime","slug":"_3d-5-three-kinds-of-datetime","link":"#_3d-5-three-kinds-of-datetime","children":[]}],"git":{"createdTime":1655981049000,"updatedTime":1737078086000,"contributors":[{"name":"trydofor","email":"trydofor@gmail.com","commits":10}]},"readingTime":{"minutes":3.27,"words":981},"filePathRelative":"3-slardar/3d-i18n-zone.md","localizedDate":"June 23, 2022","autoDesc":true}');export{A as comp,B as data};
