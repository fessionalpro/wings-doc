import{_ as p}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as h,c as r,b as i,d as s,f as a,w as n,e,o as d}from"./app-DEdToB0k.js";const k={},o=i("h1",{id:"_9a4-升迁3-0-3-300手册",tabindex:"-1"},[i("a",{class:"header-anchor",href:"#_9a4-升迁3-0-3-300手册"},[i("span",null,"9A4.升迁3.0.3.300手册")])],-1),g=i("p",null,"build升级到300，有以下重点不兼容影响。",-1),c=e('<li>java <code>17</code> 取代 <code>11</code></li><li>EE更名，以<code>jakarta</code>取代 <code>javax</code></li><li>boot以<code>3.0</code>取代<code>2.7</code>，<a href="https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Release-Notes" target="_blank" rel="noopener noreferrer">Release Notes</a></li>',3),B=e(`<h2 id="_9a4-1-修改pom-xml" tabindex="-1"><a class="header-anchor" href="#_9a4-1-修改pom-xml"><span>9A4.1.修改pom.xml</span></a></h2><p>version变为<code>3.0.3.300-SNAPSHOT</code></p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;pro.fessional&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;wings&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;3.0.3.300-SNAPSHOT&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">parent</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a4-2-依赖变更" tabindex="-1"><a class="header-anchor" href="#_9a4-2-依赖变更"><span>9A4.2.依赖变更</span></a></h2><h3 id="_2a-git-commit-id-plugin" tabindex="-1"><a class="header-anchor" href="#_2a-git-commit-id-plugin"><span>2a.<a href="https://github.com/git-commit-id/git-commit-id-maven-plugin" target="_blank" rel="noopener noreferrer">git-commit-id-plugin</a></span></a></h3><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;pl.project13.maven&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;git-commit-id-plugin&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- ↑↑变更前↑↑，↓↓变更后↓↓ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;io.github.git-commit-id&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;git-commit-id-maven-plugin&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">plugin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2b-springdoc" tabindex="-1"><a class="header-anchor" href="#_2b-springdoc"><span>2b.<a href="https://springdoc.org/v2/" target="_blank" rel="noopener noreferrer">springdoc</a></span></a></h3><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;org.springdoc&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;springdoc-openapi-ui&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;org.springdoc&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;springdoc-openapi-javadoc&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- ↑↑变更前↑↑，↓↓变更后↓↓ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;org.springdoc&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;springdoc-openapi-starter-webmvc-ui&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// import org.springdoc.api.annotations.ParameterObject;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springdoc.core.annotations.ParameterObject</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// import org.springdoc.core.SpringDocConfiguration;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springdoc.core.configuration.SpringDocConfiguration</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// import org.springdoc.core.SpringDocUtils;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springdoc.core.utils.SpringDocUtils</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">// import org.springdoc.core.customizers.OpenApiCustomizer;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> org.springdoc.core.customizers.OpenApiCustomizer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_9a4-3-javax-to-jakarta-namespace" tabindex="-1"><a class="header-anchor" href="#_9a4-3-javax-to-jakarta-namespace"><span>9A4.3.javax to jakarta namespace</span></a></h2><p>springboot3生态下，已完成了namespace的变更。wings主要涉及以下</p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" data-title="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jakarta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">annotation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">PostConstruct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jakarta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">mail</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jakarta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">servlet</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jakarta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">validation</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">jakarta</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">xml</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">bind</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要注意的，可能并非全部替换，需要区分对待和排除，</p><ul><li>并非所有的javax名词空间下都需要替换</li><li>因为间接依赖，可能同时存在javax和jakarta包</li><li>多数第三方lib，分别提供了javax和jakarta版</li><li>IDEA提供了迁移工具</li></ul><h2 id="_9a4-4-重做autogen" tabindex="-1"><a class="header-anchor" href="#_9a4-4-重做autogen"><span>9A4.4.重做Autogen</span></a></h2>`,15),A=e('<p>因已关闭JPA注解，现涉及的javax注解如下</p><ul><li>javax.annotation.processing.Generated (JDK 9+ )</li><li>javax.annotation.Generated (JDK 8- )</li></ul><h2 id="_9a4-5-add-modules及add-opens" tabindex="-1"><a class="header-anchor" href="#_9a4-5-add-modules及add-opens"><span>9A4.5.add-modules及add-opens</span></a></h2><p>java17中<code>--illegal-access=deny</code>，未<code>add-opens</code>会运行时错误。 wings的starter.sh，pom.xml，进行了正确设定，可以直接使用。</p><p>已知IDEA中，执行<code>Whole project</code>测试时，未引用surefire的<code>argLine</code>。 其结果是，部分使用反射个功能的测试用例失败。解决办法如下，</p><ul><li>以模块为单位执行，会正确设置<code>argLine</code></li><li>全工程时，需要自行指定<code>add-opens</code>，内容参考<code>argLine</code>。</li></ul><h2 id="_9a4-6-java17的语法特征调整" tabindex="-1"><a class="header-anchor" href="#_9a4-6-java17的语法特征调整"><span>9A4.6.java17的语法特征调整</span></a></h2>',7),y=i("ul",null,[i("li",null,[s("PatternVariable替换类型强转 "),i("code",null,"instanceof final G g")]),i("li",null,[s("加强版的switch，以箭头表示 "),i("code",null,"case gg -> ;")]),i("li",null,[s("text block 替换字符串拼接 "),i("code",null,'""" """')])],-1),u=e(`<ul><li>record - 出小类外，尽量用lombok，拥有更多特性和扩展性</li></ul><h2 id="_9a4-7-重要的直接依赖" tabindex="-1"><a class="header-anchor" href="#_9a4-7-重要的直接依赖"><span>9A4.7.重要的直接依赖</span></a></h2><ul><li>mirana 2.4.0-SNAPSHOT → 2.4.4-SNAPSHOT</li><li>springdoc 1.6.14 → 2.0.2 <ul><li>org.springdoc:springdoc-openapi-starter-webmvc-ui</li></ul></li><li>boot-admin 2.7.10 → 3.0.0</li><li>sentry 6.12.1 → 6.13.0 <ul><li>sentry-spring-boot-starter-jakarta</li></ul></li><li>flatten-maven-plugin 1.2.7 → 1.3.0</li></ul><h2 id="_9a4-8-wingsboot使用者" tabindex="-1"><a class="header-anchor" href="#_9a4-8-wingsboot使用者"><span>9A4.8.Wingsboot使用者</span></a></h2><p>本小节适用于以maven的parent形式使用wingsboot的IDEA工程的升级。 建议从<code>2.7.7.220</code>开始升级，否则重新生成jooq代码时，需要临时引入lib。</p><p>开始升级之前，必须注意以下事项，并在一个新的git分支上进行</p><ul><li>一步只进行一个操作，成功后再进行下一步</li><li>每一步成功时，及时提交工作区，以便轻松fallback</li><li>首先保证编译正常，然后再进行运行时的测试</li></ul><p>可使用<a href="https://github.com/spring-projects-experimental/spring-boot-migrator" target="_blank" rel="noopener noreferrer">spring-boot-migrator</a>做自动升级。</p><h3 id="_8a-修改parent-version" tabindex="-1"><a class="header-anchor" href="#_8a-修改parent-version"><span>8a.修改parent/version</span></a></h3><p>参考 <a href="#9a41%E4%BF%AE%E6%94%B9pomxml">第一小节</a>，使用<code>3.0.3.300-SNAPSHOT</code></p><p>注意，不要修改非必须的dependency版本号，仅修改wings及spring有关的。 凡是不影响编译的业务lib，都不要变动，避免一次修改太多内容，无法划清边界。</p><h3 id="_8b-设定工程jdk17" tabindex="-1"><a class="header-anchor" href="#_8b-设定工程jdk17"><span>8b.设定工程JDK17</span></a></h3><p>使用<a href="https://adoptium.net/temurin/releases/?version=17" target="_blank" rel="noopener noreferrer">Eclipse Temurin™</a>打包的OpenJDK17， 可以通过<a href="https://asdf-vm.com" target="_blank" rel="noopener noreferrer">asdf</a> 直接安装 <code>asdf install java temurin-17.0.9+9</code></p><p>重新导入maven工程，或在IDEA的菜单中设置，</p><p><code>File</code> | <code>Project Structure</code> (<code>⌘;</code>) | <code>Project</code></p><ul><li>SDK - <code>temurin-17</code></li><li>Language level - <code>SDK default</code></li></ul><h3 id="_8c-升级名词空间jakarta" tabindex="-1"><a class="header-anchor" href="#_8c-升级名词空间jakarta"><span>8c.升级名词空间jakarta</span></a></h3><p>使用IDEA的重构功能，做jakarta的名词空间迁移，建议先排除jooq自动生成的代码。</p><p><code>Refactor</code> | <code>Migrate Packages and Classes</code> | <code>JavaEE to JakartaEE</code></p><p>若包括jooq代码，<code>javax.annotation.processing.Generated</code> 不要替换。</p><p>迁移结束后，编译错误，应该主要集中在Jooq生成的代码上，解决办法参考下一节。</p><p>若有其他第三方依赖，如<code>sentry</code>，一般需要使用带<code>-jakarta</code>的<code>artifactId</code>，</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;io.sentry&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;sentry-spring-boot-starter&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- ↑↑变更前↑↑，↓↓变更后↓↓ --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;io.sentry&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;sentry-spring-boot-starter-jakarta&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8d-重新生成jooq代码" tabindex="-1"><a class="header-anchor" href="#_8d-重新生成jooq代码"><span>8d.重新生成Jooq代码</span></a></h3><p>若不是从<code>2.7.7.220</code>开始的升迁，需要临时引入以下lib，重置jooq代码后移除。</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- javax.persistence --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;jakarta.persistence&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;jakarta.persistence-api&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;!-- javax.validation.constraints --&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;jakarta.validation&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;jakarta.validation-api&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>会存在<code>jakarta.annotation.processing.Generated</code>编译错误， 需要替换回<code>javax.annotation.processing.Generated</code>。</p><h3 id="_8e-升级其他lib版本" tabindex="-1"><a class="header-anchor" href="#_8e-升级其他lib版本"><span>8e.升级其他lib版本</span></a></h3><ul><li>升级过程中，不引起编译错误的lib</li><li>影响编译，但可快速修复或隐藏的</li></ul><p>以上lib之外，建议在上述大变更完成后，逐一升级。</p><h3 id="_8f-官方检查spring-migrator" tabindex="-1"><a class="header-anchor" href="#_8f-官方检查spring-migrator"><span>8f.官方检查Spring migrator</span></a></h3><p>wings升级后，遵循spring官方的升级手册，并使用自动工具检查。</p><ul><li><a href="https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Release-Notes" target="_blank" rel="noopener noreferrer">Release Notes</a> 检查各项依赖</li><li><a href="https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide" target="_blank" rel="noopener noreferrer">3.0-Migration-Guide</a> 升级事项</li><li><a href="https://github.com/spring-projects-experimental/spring-boot-migrator" target="_blank" rel="noopener noreferrer">spring-boot-migrator</a> 自动升级工具</li></ul><p>因wings的层叠properties无法被spring识别，需要人工设定以下属性，</p><ul><li>logging.pattern.dateformat</li><li>management.endpoints.jmx.exposure.include</li></ul><h3 id="_8g-nosuchbeandefinitionexception" tabindex="-1"><a class="header-anchor" href="#_8g-nosuchbeandefinitionexception"><span>8g.NoSuchBeanDefinitionException</span></a></h3><blockquote><p>org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type &#39;.JiayuincFedexProp&#39; available: expected at least 1 bean which qualifies as autowire candidate.</p></blockquote><p>若是采用spring.factories的AutoConfiguration自动加载Bean，必须变更为以下格式， org.springframework.boot.autoconfigure.AutoConfiguration.imports</p>`,38);function m(v,b){const t=h("RouteLink"),l=h("Badge");return d(),r("div",null,[o,g,i("ul",null,[c,i("li",null,[s("检查"),a(t,{to:"/zh/9-example/9a.wings-change/9a0.notable.html"},{default:n(()=>[s("wings notable changelog")]),_:1})])]),B,i("p",null,[s("参考"),a(t,{to:"/zh/9-example/9a.wings-change/9a3.277-220.html"},{default:n(()=>[s("277.220")]),_:1}),s("升级手册。")]),A,i("p",null,[s("java17提供了比较舒服的语法特征，"),a(l,{type:"tip",vertical:"top"},{default:n(()=>[s("建议")]),_:1}),s("调整")]),y,i("p",null,[s("以下特征"),a(l,{type:"note",vertical:"top"},{default:n(()=>[s("不建议")]),_:1}),s("调整")]),u])}const f=p(k,[["render",m],["__file","9a4.303-300.html.vue"]]),_=JSON.parse('{"path":"/zh/9-example/9a.wings-change/9a4.303-300.html","title":"9A4.升迁3.0.3.300手册","lang":"zh-CN","frontmatter":{"isOriginal":true,"icon":"circle-up","category":["实战","升迁"],"description":"9A4.升迁3.0.3.300手册 build升级到300，有以下重点不兼容影响。 java 17 取代 11 EE更名，以jakarta取代 javax boot以3.0取代2.7，Release Notes 检查 9A4.1.修改pom.xml version变为3.0.3.300-SNAPSHOT 9A4.2.依赖变更 2a.git-commit...","GIT_REPO_HEAD":"2025-01-17 e638e7035dc7958e3f145793e37c871eb02f12d5","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://wings.fessional.pro/9-example/9a.wings-change/9a4.303-300.html"}],["meta",{"property":"og:url","content":"https://wings.fessional.pro/zh/9-example/9a.wings-change/9a4.303-300.html"}],["meta",{"property":"og:site_name","content":"WingsBoot 纹丝不忒"}],["meta",{"property":"og:title","content":"9A4.升迁3.0.3.300手册"}],["meta",{"property":"og:description","content":"9A4.升迁3.0.3.300手册 build升级到300，有以下重点不兼容影响。 java 17 取代 11 EE更名，以jakarta取代 javax boot以3.0取代2.7，Release Notes 检查 9A4.1.修改pom.xml version变为3.0.3.300-SNAPSHOT 9A4.2.依赖变更 2a.git-commit..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-01-09T11:57:11.000Z"}],["meta",{"property":"article:author","content":"trydofor"}],["meta",{"property":"article:modified_time","content":"2025-01-09T11:57:11.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"9A4.升迁3.0.3.300手册\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-01-09T11:57:11.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"trydofor\\",\\"url\\":\\"https://www.trydofor.com\\"}]}"]]},"headers":[{"level":2,"title":"9A4.1.修改pom.xml","slug":"_9a4-1-修改pom-xml","link":"#_9a4-1-修改pom-xml","children":[]},{"level":2,"title":"9A4.2.依赖变更","slug":"_9a4-2-依赖变更","link":"#_9a4-2-依赖变更","children":[{"level":3,"title":"2a.git-commit-id-plugin","slug":"_2a-git-commit-id-plugin","link":"#_2a-git-commit-id-plugin","children":[]},{"level":3,"title":"2b.springdoc","slug":"_2b-springdoc","link":"#_2b-springdoc","children":[]}]},{"level":2,"title":"9A4.3.javax to jakarta namespace","slug":"_9a4-3-javax-to-jakarta-namespace","link":"#_9a4-3-javax-to-jakarta-namespace","children":[]},{"level":2,"title":"9A4.4.重做Autogen","slug":"_9a4-4-重做autogen","link":"#_9a4-4-重做autogen","children":[]},{"level":2,"title":"9A4.5.add-modules及add-opens","slug":"_9a4-5-add-modules及add-opens","link":"#_9a4-5-add-modules及add-opens","children":[]},{"level":2,"title":"9A4.6.java17的语法特征调整","slug":"_9a4-6-java17的语法特征调整","link":"#_9a4-6-java17的语法特征调整","children":[]},{"level":2,"title":"9A4.7.重要的直接依赖","slug":"_9a4-7-重要的直接依赖","link":"#_9a4-7-重要的直接依赖","children":[]},{"level":2,"title":"9A4.8.Wingsboot使用者","slug":"_9a4-8-wingsboot使用者","link":"#_9a4-8-wingsboot使用者","children":[{"level":3,"title":"8a.修改parent/version","slug":"_8a-修改parent-version","link":"#_8a-修改parent-version","children":[]},{"level":3,"title":"8b.设定工程JDK17","slug":"_8b-设定工程jdk17","link":"#_8b-设定工程jdk17","children":[]},{"level":3,"title":"8c.升级名词空间jakarta","slug":"_8c-升级名词空间jakarta","link":"#_8c-升级名词空间jakarta","children":[]},{"level":3,"title":"8d.重新生成Jooq代码","slug":"_8d-重新生成jooq代码","link":"#_8d-重新生成jooq代码","children":[]},{"level":3,"title":"8e.升级其他lib版本","slug":"_8e-升级其他lib版本","link":"#_8e-升级其他lib版本","children":[]},{"level":3,"title":"8f.官方检查Spring migrator","slug":"_8f-官方检查spring-migrator","link":"#_8f-官方检查spring-migrator","children":[]},{"level":3,"title":"8g.NoSuchBeanDefinitionException","slug":"_8g-nosuchbeandefinitionexception","link":"#_8g-nosuchbeandefinitionexception","children":[]}]}],"git":{"createdTime":1675228675000,"updatedTime":1736423831000,"contributors":[{"name":"trydofor","email":"trydofor@gmail.com","commits":5}]},"readingTime":{"minutes":4.21,"words":1263},"filePathRelative":"zh/9-example/9a.wings-change/9a4.303-300.md","localizedDate":"2023年2月1日","autoDesc":true}');export{f as comp,_ as data};
